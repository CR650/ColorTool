# 表格转JSON工具使用说明

## 🎯 工具概述

表格转JSON工具是一个简单易用的在线工具，可以将Excel文件（.xlsx, .xls）和CSV文件快速转换为JSON格式。支持多种输出格式和自定义转换选项。

## ✨ 主要功能

### 支持的文件格式
- **Excel文件**: .xlsx, .xls (支持多工作表)
- **CSV文件**: .csv (逗号分隔值)

### JSON输出格式
1. **对象数组格式** (默认)
   ```json
   [
     {"姓名": "张三", "年龄": "25", "城市": "北京"},
     {"姓名": "李四", "年龄": "30", "城市": "上海"}
   ]
   ```

2. **键值对格式**
   ```json
   {
     "行1": {"姓名": "张三", "年龄": "25", "城市": "北京"},
     "行2": {"姓名": "李四", "年龄": "30", "城市": "上海"}
   }
   ```

3. **嵌套对象格式**
   ```json
   {
     "metadata": {
       "fileName": "示例.xlsx",
       "sheetName": "Sheet1",
       "totalRows": 2,
       "totalColumns": 3,
       "exportTime": "2025-01-09T10:30:00.000Z"
     },
     "headers": ["姓名", "年龄", "城市"],
     "data": [
       {"姓名": "张三", "年龄": "25", "城市": "北京"},
       {"姓名": "李四", "年龄": "30", "城市": "上海"}
     ]
   }
   ```

## 📖 使用步骤

### 第一步：选择文件
1. 点击"选择文件"按钮或直接拖拽文件到上传区域
2. 支持的文件格式：.xlsx, .xls, .csv
3. 文件大小限制：50MB以内

### 第二步：选择工作表（Excel文件）
1. 如果是Excel文件且包含多个工作表，请选择要转换的工作表
2. 单工作表文件会自动选择
3. 可以查看工作表的行列数信息

### 第三步：配置转换选项

#### 数据处理选项
- **包含表头作为键名**: 使用第一行作为JSON对象的键名
- **跳过空行**: 忽略完全为空的行
- **去除首尾空格**: 自动清理文本数据的空格

#### JSON格式选项
- **对象数组格式**: 最常用的JSON格式
- **键值对格式**: 以行号为键的对象结构
- **嵌套对象格式**: 包含完整元数据的结构

#### 空值处理选项
- **转换为 null**: 空值显示为 null
- **转换为空字符串**: 空值显示为 ""
- **跳过空值字段**: 不包含空值字段

### 第四步：预览和转换
1. 在"数据预览"区域查看表格数据和JSON预览
2. 点击"转换为JSON"按钮进行转换
3. 查看转换结果统计信息

### 第五步：下载或复制
1. 点击"下载JSON文件"保存到本地
2. 点击"复制到剪贴板"直接复制JSON内容
3. 文件名格式：`原文件名_工作表名.json`

## 🔧 高级功能

### 拖拽上传
- 直接将文件拖拽到上传区域
- 支持拖拽时的视觉反馈
- 自动识别文件类型

### 实时预览
- 表格数据预览（限制显示前100行）
- JSON格式实时预览
- 数据统计信息显示

### 响应式设计
- 支持桌面和移动设备
- 自适应屏幕尺寸
- 触摸友好的界面

## ⚠️ 注意事项

### 文件限制
- 最大文件大小：50MB
- 支持的编码：UTF-8（推荐）、GBK
- Excel版本：支持Excel 2007及以上版本

### 数据处理
- 数字会自动识别并转换为数值类型
- 日期格式可能需要手动处理
- 特殊字符会保持原样

### 浏览器兼容性
- **推荐浏览器**: Chrome 60+, Firefox 55+, Safari 12+, Edge 79+
- **功能支持**: 现代浏览器支持所有功能
- **移动端**: 支持iOS Safari和Android Chrome

## 🛠️ 故障排除

### 常见问题

**Q: 文件上传失败怎么办？**
A: 检查文件格式是否正确，文件大小是否超过50MB限制。

**Q: 中文显示乱码怎么办？**
A: 确保CSV文件使用UTF-8编码保存，或尝试使用Excel格式。

**Q: 转换后的JSON格式不对？**
A: 检查转换选项设置，特别是"包含表头作为键名"选项。

**Q: 无法下载文件？**
A: 检查浏览器是否阻止了下载，或尝试使用"复制到剪贴板"功能。

### 性能优化建议
- 大文件建议分批处理
- 复杂数据建议先在Excel中整理
- 移动设备上建议处理较小的文件

## 📝 示例数据

### Excel示例
创建一个包含以下数据的Excel文件：

| 姓名 | 年龄 | 城市 | 职业 |
|------|------|------|------|
| 张三 | 25   | 北京 | 工程师 |
| 李四 | 30   | 上海 | 设计师 |
| 王五 | 28   | 广州 | 产品经理 |

### CSV示例
```csv
姓名,年龄,城市,职业
张三,25,北京,工程师
李四,30,上海,设计师
王五,28,广州,产品经理
```

### 转换结果（对象数组格式）
```json
[
  {
    "姓名": "张三",
    "年龄": 25,
    "城市": "北京",
    "职业": "工程师"
  },
  {
    "姓名": "李四",
    "年龄": 30,
    "城市": "上海",
    "职业": "设计师"
  },
  {
    "姓名": "王五",
    "年龄": 28,
    "城市": "广州",
    "职业": "产品经理"
  }
]
```

## 🔗 相关链接

- [在线工具地址](./table-to-json.html)
- [项目源码](https://github.com/your-repo/table-to-json)
- [问题反馈](https://github.com/your-repo/table-to-json/issues)

## 📄 版本信息

- **当前版本**: v1.0.0
- **更新日期**: 2025-01-09
- **兼容性**: 现代浏览器

---

*如有任何问题或建议，欢迎通过GitHub Issues反馈。*
