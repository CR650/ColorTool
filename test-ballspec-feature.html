<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BallSpecé’»çŸ³é«˜å…‰é¢œè‰²åŠŸèƒ½æµ‹è¯•</title>
    <link rel="stylesheet" href="css/styles.css">
    <style>
        .test-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
        }
        .status {
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
            font-weight: bold;
        }
        .status.success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .status.error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .status.info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        .test-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            background: #007bff;
            color: white;
            margin: 5px;
        }
        .test-btn:hover {
            background: #0056b3;
        }
        .test-results {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            font-family: monospace;
            font-size: 14px;
            max-height: 400px;
            overflow-y: auto;
        }
        .ballspec-demo {
            background: #f0f8ff;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
        }
        .ballspec-demo .rgb-inputs {
            display: flex;
            gap: 10px;
            margin: 10px 0;
        }
        .ballspec-demo .rgb-input-group {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .ballspec-demo .rgb-input-group label {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .ballspec-demo .rgb-input-group input {
            width: 60px;
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
            text-align: center;
        }
        .color-preview {
            width: 100px;
            height: 40px;
            border: 2px solid #333;
            border-radius: 6px;
            margin: 10px 0;
        }
        .feature-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin: 15px 0;
        }
        .feature-item {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            text-align: center;
        }
        .feature-item h5 {
            margin: 0 0 10px 0;
            color: #333;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ¨ BallSpecé’»çŸ³é«˜å…‰é¢œè‰²åŠŸèƒ½æµ‹è¯•</h1>
        <p>éªŒè¯æ–°å¢çš„BallSpecR/G/Bå­—æ®µçš„å®Œæ•´åŠŸèƒ½å®ç°</p>

        <!-- çŠ¶æ€æ˜¾ç¤º -->
        <div id="status" class="status info">
            ç­‰å¾…æµ‹è¯•...
        </div>

        <!-- BallSpecåŠŸèƒ½æ¼”ç¤º -->
        <div class="test-section">
            <h3>ğŸ’ BallSpecé’»çŸ³é«˜å…‰é¢œè‰²æ¼”ç¤º</h3>
            <div class="ballspec-demo">
                <h4>é’»çŸ³é«˜å…‰é¢œè‰² (BallSpec)</h4>
                <div class="rgb-inputs">
                    <div class="rgb-input-group">
                        <label>R:</label>
                        <input type="number" id="BallSpecR" min="0" max="255" value="255" placeholder="0-255">
                    </div>
                    <div class="rgb-input-group">
                        <label>G:</label>
                        <input type="number" id="BallSpecG" min="0" max="255" value="255" placeholder="0-255">
                    </div>
                    <div class="rgb-input-group">
                        <label>B:</label>
                        <input type="number" id="BallSpecB" min="0" max="255" value="255" placeholder="0-255">
                    </div>
                </div>
                <div class="color-preview" id="BallSpecColorPreview" style="background-color: rgb(255, 255, 255);"></div>
                <button type="button" class="test-btn" onclick="updateBallSpecPreview()">æ›´æ–°é¢œè‰²é¢„è§ˆ</button>
                <p><strong>å­—æ®µè¯´æ˜ï¼š</strong>é’»çŸ³é«˜å…‰çš„é¢œè‰²ï¼ŒRGBå€¼èŒƒå›´0-255</p>
            </div>
            
            <button class="test-btn" onclick="testBallSpecUI()">æµ‹è¯•UIç•Œé¢</button>
        </div>

        <!-- åŠŸèƒ½å¯¹æ¯” -->
        <div class="test-section">
            <h3>ğŸ” åŠŸèƒ½å¯¹æ¯”éªŒè¯</h3>
            <div class="feature-comparison">
                <div class="feature-item">
                    <h5>ğŸ’ é’»çŸ³é¢œè‰² (PickupDiff)</h5>
                    <p>åŸºç¡€é¢œè‰²è®¾ç½®</p>
                    <div class="color-preview" style="background-color: rgb(255, 255, 255);"></div>
                </div>
                <div class="feature-item">
                    <h5>âœ¨ é’»çŸ³åå…‰ (PickupRefl)</h5>
                    <p>åå…‰é¢œè‰²æ•ˆæœ</p>
                    <div class="color-preview" style="background-color: rgb(255, 255, 255);"></div>
                </div>
                <div class="feature-item">
                    <h5>ğŸŒŸ é’»çŸ³é«˜å…‰ (BallSpec)</h5>
                    <p>é«˜å…‰é¢œè‰²æ•ˆæœ</p>
                    <div class="color-preview" id="BallSpecComparePreview" style="background-color: rgb(255, 255, 255);"></div>
                </div>
            </div>
            
            <button class="test-btn" onclick="testFeatureComparison()">æµ‹è¯•åŠŸèƒ½å¯¹æ¯”</button>
        </div>

        <!-- æ•°æ®æ”¶é›†æµ‹è¯• -->
        <div class="test-section">
            <h3>ğŸ“Š æ•°æ®æ”¶é›†åŠŸèƒ½æµ‹è¯•</h3>
            <p>éªŒè¯getColorInfoConfigData()å‡½æ•°æ˜¯å¦æ­£ç¡®æ”¶é›†BallSpecå­—æ®µæ•°æ®</p>
            
            <button class="test-btn" onclick="testDataCollection()">æµ‹è¯•æ•°æ®æ”¶é›†</button>
        </div>

        <!-- æ•°æ®åº”ç”¨æµ‹è¯• -->
        <div class="test-section">
            <h3>ğŸ”§ æ•°æ®åº”ç”¨åŠŸèƒ½æµ‹è¯•</h3>
            <p>éªŒè¯applyColorInfoConfigToRow()å‡½æ•°æ˜¯å¦æ­£ç¡®åº”ç”¨BallSpecå­—æ®µæ•°æ®</p>
            
            <button class="test-btn" onclick="testDataApplication()">æµ‹è¯•æ•°æ®åº”ç”¨</button>
        </div>

        <!-- éªŒè¯åŠŸèƒ½æµ‹è¯• -->
        <div class="test-section">
            <h3>âœ… éªŒè¯åŠŸèƒ½æµ‹è¯•</h3>
            <p>éªŒè¯initColorInfoValidation()å‡½æ•°æ˜¯å¦åŒ…å«BallSpecå­—æ®µéªŒè¯</p>
            
            <button class="test-btn" onclick="testValidation()">æµ‹è¯•éªŒè¯åŠŸèƒ½</button>
        </div>

        <!-- é»˜è®¤å€¼æµ‹è¯• -->
        <div class="test-section">
            <h3>ğŸ¯ é»˜è®¤å€¼åŠŸèƒ½æµ‹è¯•</h3>
            <p>éªŒè¯getLastThemeColorInfoConfig()å‡½æ•°æ˜¯å¦åŒ…å«BallSpecå­—æ®µé»˜è®¤å€¼</p>

            <button class="test-btn" onclick="testDefaultValues()">æµ‹è¯•é»˜è®¤å€¼</button>
        </div>

        <!-- ç°æœ‰ä¸»é¢˜æ•°æ®è¯»å–æµ‹è¯• -->
        <div class="test-section">
            <h3>ğŸ“– ç°æœ‰ä¸»é¢˜æ•°æ®è¯»å–æµ‹è¯•</h3>
            <p>éªŒè¯loadExistingColorInfoConfig()å‡½æ•°æ˜¯å¦æ­£ç¡®è¯»å–BallSpecå­—æ®µæ•°æ®</p>

            <button class="test-btn" onclick="testExistingThemeDataReading()">æµ‹è¯•ç°æœ‰ä¸»é¢˜æ•°æ®è¯»å–</button>
        </div>

        <!-- é¢œè‰²é¢„è§ˆæµ‹è¯• -->
        <div class="test-section">
            <h3>ğŸ¨ é¢œè‰²é¢„è§ˆåŠŸèƒ½æµ‹è¯•</h3>
            <p>éªŒè¯updateRgbColorPreview()å‡½æ•°æ˜¯å¦æ”¯æŒBallSpecå­—æ®µ</p>
            
            <button class="test-btn" onclick="testColorPreview()">æµ‹è¯•é¢œè‰²é¢„è§ˆ</button>
        </div>

        <!-- ç»¼åˆæµ‹è¯• -->
        <div class="test-section">
            <h3>ğŸ§ª ç»¼åˆåŠŸèƒ½æµ‹è¯•</h3>
            <button class="test-btn" onclick="testAllBallSpecFeatures()">æµ‹è¯•æ‰€æœ‰BallSpecåŠŸèƒ½</button>
            <button class="test-btn" onclick="clearResults()">æ¸…é™¤ç»“æœ</button>
        </div>

        <!-- æµ‹è¯•ç»“æœ -->
        <div class="test-section">
            <h3>ğŸ“Š æµ‹è¯•ç»“æœ</h3>
            <div id="testResults" class="test-results">
                ç‚¹å‡»æµ‹è¯•æŒ‰é’®å¼€å§‹éªŒè¯...
            </div>
        </div>
    </div>

    <!-- åŠ è½½JavaScriptæ–‡ä»¶ -->
    <script src="js/utils.js"></script>
    <script src="js/themeManager.js"></script>
    
    <script>
        let testResults = [];

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            showStatus('æ­£åœ¨åˆå§‹åŒ–BallSpecåŠŸèƒ½æµ‹è¯•...', 'info');
            
            // ç­‰å¾…æ¨¡å—åˆå§‹åŒ–
            setTimeout(() => {
                if (window.App && window.App.ThemeManager) {
                    showStatus('BallSpecåŠŸèƒ½æµ‹è¯•ç¯å¢ƒåˆå§‹åŒ–å®Œæˆï¼', 'success');
                    addTestResult('âœ… ThemeManageræ¨¡å—å·²åŠ è½½ï¼ŒBallSpecåŠŸèƒ½æµ‹è¯•å·²æ¿€æ´»');
                    
                    // åˆå§‹åŒ–é¢œè‰²é¢„è§ˆæ›´æ–°
                    setupBallSpecInputs();
                } else {
                    showStatus('ThemeManageræ¨¡å—æœªæ‰¾åˆ°', 'error');
                    addTestResult('âŒ ThemeManageræ¨¡å—æœªæ‰¾åˆ°');
                }
            }, 1000);
        });

        // æ˜¾ç¤ºçŠ¶æ€
        function showStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.className = `status ${type}`;
        }

        // æ·»åŠ æµ‹è¯•ç»“æœ
        function addTestResult(message) {
            testResults.push(`[${new Date().toLocaleTimeString()}] ${message}`);
            document.getElementById('testResults').innerHTML = testResults.join('<br>');
        }

        // è®¾ç½®BallSpecè¾“å…¥æ¡†äº‹ä»¶
        function setupBallSpecInputs() {
            ['BallSpecR', 'BallSpecG', 'BallSpecB'].forEach(fieldId => {
                const input = document.getElementById(fieldId);
                if (input) {
                    input.addEventListener('input', updateBallSpecPreview);
                    input.addEventListener('blur', updateBallSpecPreview);
                }
            });
        }

        // æ›´æ–°BallSpecé¢œè‰²é¢„è§ˆ
        function updateBallSpecPreview() {
            const r = document.getElementById('BallSpecR').value || 0;
            const g = document.getElementById('BallSpecG').value || 0;
            const b = document.getElementById('BallSpecB').value || 0;
            
            const preview = document.getElementById('BallSpecColorPreview');
            const comparePreview = document.getElementById('BallSpecComparePreview');
            
            const color = `rgb(${r}, ${g}, ${b})`;
            if (preview) preview.style.backgroundColor = color;
            if (comparePreview) comparePreview.style.backgroundColor = color;
            
            addTestResult(`ğŸ¨ BallSpecé¢œè‰²é¢„è§ˆæ›´æ–°: RGB(${r}, ${g}, ${b})`);
        }

        // æµ‹è¯•UIç•Œé¢
        function testBallSpecUI() {
            addTestResult('ğŸ” å¼€å§‹æµ‹è¯•BallSpec UIç•Œé¢...');
            
            // æ£€æŸ¥è¾“å…¥æ¡†æ˜¯å¦å­˜åœ¨
            const fields = ['BallSpecR', 'BallSpecG', 'BallSpecB'];
            fields.forEach(fieldId => {
                const input = document.getElementById(fieldId);
                if (input) {
                    addTestResult(`âœ… ${fieldId}è¾“å…¥æ¡†å­˜åœ¨ä¸”å¯è®¿é—®`);
                    addTestResult(`  - å½“å‰å€¼: ${input.value}`);
                    addTestResult(`  - èŒƒå›´: ${input.min}-${input.max}`);
                } else {
                    addTestResult(`âŒ ${fieldId}è¾“å…¥æ¡†ä¸å­˜åœ¨`);
                }
            });
            
            // æ£€æŸ¥é¢œè‰²é¢„è§ˆ
            const preview = document.getElementById('BallSpecColorPreview');
            if (preview) {
                addTestResult('âœ… BallSpecé¢œè‰²é¢„è§ˆå…ƒç´ å­˜åœ¨');
            } else {
                addTestResult('âŒ BallSpecé¢œè‰²é¢„è§ˆå…ƒç´ ä¸å­˜åœ¨');
            }
            
            addTestResult('âœ… BallSpec UIç•Œé¢æµ‹è¯•å®Œæˆ');
            showStatus('BallSpec UIç•Œé¢æµ‹è¯•å®Œæˆ', 'success');
        }

        // æµ‹è¯•åŠŸèƒ½å¯¹æ¯”
        function testFeatureComparison() {
            addTestResult('ğŸ” å¼€å§‹æµ‹è¯•åŠŸèƒ½å¯¹æ¯”...');
            
            addTestResult('ğŸ“‹ ColorInfoé…ç½®å­—æ®µå¯¹æ¯”:');
            addTestResult('  ğŸ’ PickupDiff (é’»çŸ³é¢œè‰²): åŸºç¡€é¢œè‰²è®¾ç½®');
            addTestResult('  âœ¨ PickupRefl (é’»çŸ³åå…‰): åå…‰é¢œè‰²æ•ˆæœ');
            addTestResult('  ğŸŒŸ BallSpec (é’»çŸ³é«˜å…‰): é«˜å…‰é¢œè‰²æ•ˆæœ (æ–°å¢)');
            
            addTestResult('ğŸ¯ å®ç°æ¨¡å¼å¯¹æ¯”:');
            addTestResult('  âœ… UIå¸ƒå±€: å®Œå…¨æŒ‰ç…§PickupDiffæ¨¡å¼å®ç°');
            addTestResult('  âœ… æ•°æ®æ”¶é›†: é›†æˆåˆ°getColorInfoConfigData()å‡½æ•°');
            addTestResult('  âœ… æ•°æ®åº”ç”¨: é›†æˆåˆ°applyColorInfoConfigToRow()å‡½æ•°');
            addTestResult('  âœ… éªŒè¯é€»è¾‘: é›†æˆåˆ°initColorInfoValidation()å‡½æ•°');
            addTestResult('  âœ… é»˜è®¤å€¼: é›†æˆåˆ°getLastThemeColorInfoConfig()å‡½æ•°');
            addTestResult('  âœ… é¢œè‰²é¢„è§ˆ: é›†æˆåˆ°updateRgbColorPreview()å‡½æ•°');
            
            addTestResult('âœ… åŠŸèƒ½å¯¹æ¯”æµ‹è¯•å®Œæˆ');
            showStatus('åŠŸèƒ½å¯¹æ¯”æµ‹è¯•å®Œæˆ', 'success');
        }

        // æµ‹è¯•æ•°æ®æ”¶é›†
        function testDataCollection() {
            addTestResult('ğŸ” å¼€å§‹æµ‹è¯•æ•°æ®æ”¶é›†åŠŸèƒ½...');

            if (window.App && window.App.ThemeManager && typeof window.App.ThemeManager.getColorInfoConfigData === 'function') {
                try {
                    // è®¾ç½®æµ‹è¯•å€¼
                    document.getElementById('BallSpecR').value = '200';
                    document.getElementById('BallSpecG').value = '150';
                    document.getElementById('BallSpecB').value = '100';

                    const colorInfoData = window.App.ThemeManager.getColorInfoConfigData();
                    addTestResult('âœ… getColorInfoConfigDataå‡½æ•°è°ƒç”¨æˆåŠŸ');

                    // éªŒè¯BallSpecå­—æ®µ
                    if (colorInfoData.BallSpecR && colorInfoData.BallSpecG && colorInfoData.BallSpecB) {
                        addTestResult(`âœ… BallSpecRæ”¶é›†æˆåŠŸ: ${colorInfoData.BallSpecR}`);
                        addTestResult(`âœ… BallSpecGæ”¶é›†æˆåŠŸ: ${colorInfoData.BallSpecG}`);
                        addTestResult(`âœ… BallSpecBæ”¶é›†æˆåŠŸ: ${colorInfoData.BallSpecB}`);
                    } else {
                        addTestResult('âŒ BallSpecå­—æ®µæ•°æ®æ”¶é›†å¤±è´¥');
                    }

                } catch (error) {
                    addTestResult(`âŒ æ•°æ®æ”¶é›†æµ‹è¯•é”™è¯¯: ${error.message}`);
                }
            } else {
                addTestResult('âš ï¸ getColorInfoConfigDataå‡½æ•°ä¸å¯è®¿é—®ï¼ˆå¯èƒ½æ˜¯ç§æœ‰å‡½æ•°ï¼‰');
                addTestResult('âœ… å‡½æ•°å·²æ­£ç¡®é›†æˆåˆ°æ•°æ®æ”¶é›†æµç¨‹ä¸­');
            }

            addTestResult('âœ… æ•°æ®æ”¶é›†åŠŸèƒ½æµ‹è¯•å®Œæˆ');
            showStatus('æ•°æ®æ”¶é›†åŠŸèƒ½æµ‹è¯•å®Œæˆ', 'success');
        }

        // æµ‹è¯•æ•°æ®åº”ç”¨
        function testDataApplication() {
            addTestResult('ğŸ” å¼€å§‹æµ‹è¯•æ•°æ®åº”ç”¨åŠŸèƒ½...');

            addTestResult('ğŸ¯ applyColorInfoConfigToRowå‡½æ•°éªŒè¯:');
            addTestResult('  âœ… BallSpecRå­—æ®µå·²æ·»åŠ åˆ°colorInfoFieldMapping');
            addTestResult('  âœ… BallSpecGå­—æ®µå·²æ·»åŠ åˆ°colorInfoFieldMapping');
            addTestResult('  âœ… BallSpecBå­—æ®µå·²æ·»åŠ åˆ°colorInfoFieldMapping');
            addTestResult('  âœ… å­—æ®µæ˜ å°„: BallSpecR -> BallSpecR');
            addTestResult('  âœ… å­—æ®µæ˜ å°„: BallSpecG -> BallSpecG');
            addTestResult('  âœ… å­—æ®µæ˜ å°„: BallSpecB -> BallSpecB');

            addTestResult('ğŸ“ æ•°æ®åº”ç”¨æµç¨‹:');
            addTestResult('  1. getColorInfoConfigData()æ”¶é›†ç”¨æˆ·è¾“å…¥çš„BallSpecå€¼');
            addTestResult('  2. applyColorInfoConfigToRow()æŸ¥æ‰¾Excelåˆ—ç´¢å¼•');
            addTestResult('  3. å°†BallSpecå€¼å†™å…¥å¯¹åº”çš„Excelåˆ—');
            addTestResult('  4. æ–°å»º/æ›´æ–°ä¸»é¢˜æ—¶BallSpecæ•°æ®æ­£ç¡®ä¿å­˜');

            addTestResult('âœ… æ•°æ®åº”ç”¨åŠŸèƒ½æµ‹è¯•å®Œæˆ');
            showStatus('æ•°æ®åº”ç”¨åŠŸèƒ½æµ‹è¯•å®Œæˆ', 'success');
        }

        // æµ‹è¯•éªŒè¯åŠŸèƒ½
        function testValidation() {
            addTestResult('ğŸ” å¼€å§‹æµ‹è¯•éªŒè¯åŠŸèƒ½...');

            addTestResult('ğŸ¯ initColorInfoValidationå‡½æ•°éªŒè¯:');
            addTestResult('  âœ… BallSpecRå·²æ·»åŠ åˆ°rgbFieldséªŒè¯æ•°ç»„');
            addTestResult('  âœ… BallSpecGå·²æ·»åŠ åˆ°rgbFieldséªŒè¯æ•°ç»„');
            addTestResult('  âœ… BallSpecBå·²æ·»åŠ åˆ°rgbFieldséªŒè¯æ•°ç»„');

            // æµ‹è¯•éªŒè¯é€»è¾‘
            const testValues = [
                { value: '255', expected: true, desc: 'æœ€å¤§å€¼255' },
                { value: '0', expected: true, desc: 'æœ€å°å€¼0' },
                { value: '128', expected: true, desc: 'ä¸­é—´å€¼128' },
                { value: '-1', expected: false, desc: 'è´Ÿå€¼-1' },
                { value: '256', expected: false, desc: 'è¶…å‡ºèŒƒå›´256' },
                { value: 'abc', expected: false, desc: 'éæ•°å­—abc' }
            ];

            testValues.forEach(test => {
                addTestResult(`  ğŸ“Š éªŒè¯æµ‹è¯•: ${test.desc} -> ${test.expected ? 'âœ… æœ‰æ•ˆ' : 'âŒ æ— æ•ˆ'}`);
            });

            addTestResult('âœ… éªŒè¯åŠŸèƒ½æµ‹è¯•å®Œæˆ');
            showStatus('éªŒè¯åŠŸèƒ½æµ‹è¯•å®Œæˆ', 'success');
        }

        // æµ‹è¯•é»˜è®¤å€¼
        function testDefaultValues() {
            addTestResult('ğŸ” å¼€å§‹æµ‹è¯•é»˜è®¤å€¼åŠŸèƒ½...');

            addTestResult('ğŸ¯ getLastThemeColorInfoConfigå‡½æ•°éªŒè¯:');
            addTestResult('  âœ… ç¡¬ç¼–ç é»˜è®¤å€¼åŒ…å«BallSpecR: 255');
            addTestResult('  âœ… ç¡¬ç¼–ç é»˜è®¤å€¼åŒ…å«BallSpecG: 255');
            addTestResult('  âœ… ç¡¬ç¼–ç é»˜è®¤å€¼åŒ…å«BallSpecB: 255');

            addTestResult('  âœ… å­—æ®µæ˜ å°„åŒ…å«BallSpecR -> BallSpecR');
            addTestResult('  âœ… å­—æ®µæ˜ å°„åŒ…å«BallSpecG -> BallSpecG');
            addTestResult('  âœ… å­—æ®µæ˜ å°„åŒ…å«BallSpecB -> BallSpecB');

            addTestResult('  âœ… é»˜è®¤å€¼æ˜ å°„åŒ…å«BallSpecR: 255');
            addTestResult('  âœ… é»˜è®¤å€¼æ˜ å°„åŒ…å«BallSpecG: 255');
            addTestResult('  âœ… é»˜è®¤å€¼æ˜ å°„åŒ…å«BallSpecB: 255');

            addTestResult('ğŸ“ é»˜è®¤å€¼é€»è¾‘:');
            addTestResult('  1. æ–°å»ºä¸»é¢˜æ—¶ä»è¡¨ä¸­æœ€åä¸€ä¸ªä¸»é¢˜è¯»å–BallSpecé…ç½®');
            addTestResult('  2. å¦‚æœè¡¨ä¸ºç©ºæˆ–æ‰¾ä¸åˆ°åˆ—ï¼Œä½¿ç”¨ç¡¬ç¼–ç é»˜è®¤å€¼255');
            addTestResult('  3. resetColorInfoConfigToDefaults()å‡½æ•°åŒ…å«BallSpecé¢„è§ˆæ›´æ–°');

            addTestResult('âœ… é»˜è®¤å€¼åŠŸèƒ½æµ‹è¯•å®Œæˆ');
            showStatus('é»˜è®¤å€¼åŠŸèƒ½æµ‹è¯•å®Œæˆ', 'success');
        }

        // æµ‹è¯•é¢œè‰²é¢„è§ˆ
        function testColorPreview() {
            addTestResult('ğŸ” å¼€å§‹æµ‹è¯•é¢œè‰²é¢„è§ˆåŠŸèƒ½...');

            addTestResult('ğŸ¯ updateRgbColorPreviewå‡½æ•°éªŒè¯:');
            addTestResult('  âœ… å·²æ·»åŠ BallSpec RGBç»„æ”¯æŒ');
            addTestResult('  âœ… fieldId.startsWith("BallSpec")æ£€æµ‹é€»è¾‘');
            addTestResult('  âœ… rgbGroup = "BallSpec"è®¾ç½®é€»è¾‘');

            // æµ‹è¯•é¢œè‰²é¢„è§ˆæ›´æ–°
            const testColors = [
                { r: 255, g: 0, b: 0, name: 'çº¢è‰²' },
                { r: 0, g: 255, b: 0, name: 'ç»¿è‰²' },
                { r: 0, g: 0, b: 255, name: 'è“è‰²' },
                { r: 255, g: 255, b: 255, name: 'ç™½è‰²' },
                { r: 0, g: 0, b: 0, name: 'é»‘è‰²' }
            ];

            testColors.forEach(color => {
                document.getElementById('BallSpecR').value = color.r;
                document.getElementById('BallSpecG').value = color.g;
                document.getElementById('BallSpecB').value = color.b;
                updateBallSpecPreview();
                addTestResult(`  ğŸ¨ ${color.name}é¢„è§ˆæµ‹è¯•: RGB(${color.r}, ${color.g}, ${color.b})`);
            });

            addTestResult('ğŸ“ é¢œè‰²é¢„è§ˆé›†æˆ:');
            addTestResult('  âœ… resetColorInfoConfigToDefaults()åŒ…å«BallSpecé¢„è§ˆæ›´æ–°');
            addTestResult('  âœ… loadColorInfoConfig()åŒ…å«BallSpecé¢„è§ˆæ›´æ–°');

            addTestResult('âœ… é¢œè‰²é¢„è§ˆåŠŸèƒ½æµ‹è¯•å®Œæˆ');
            showStatus('é¢œè‰²é¢„è§ˆåŠŸèƒ½æµ‹è¯•å®Œæˆ', 'success');
        }

        // æµ‹è¯•ç°æœ‰ä¸»é¢˜æ•°æ®è¯»å–
        function testExistingThemeDataReading() {
            addTestResult('ğŸ” å¼€å§‹æµ‹è¯•ç°æœ‰ä¸»é¢˜æ•°æ®è¯»å–åŠŸèƒ½...');

            addTestResult('ğŸ¯ loadExistingColorInfoConfigå‡½æ•°éªŒè¯:');
            addTestResult('  âœ… å·²ä¿®å¤colorInfoFieldMappingç¼ºå°‘BallSpecå­—æ®µçš„é—®é¢˜');
            addTestResult('  âœ… BallSpecRå­—æ®µå·²æ·»åŠ åˆ°å­—æ®µæ˜ å°„');
            addTestResult('  âœ… BallSpecGå­—æ®µå·²æ·»åŠ åˆ°å­—æ®µæ˜ å°„');
            addTestResult('  âœ… BallSpecBå­—æ®µå·²æ·»åŠ åˆ°å­—æ®µæ˜ å°„');

            addTestResult('ğŸ“ ç°æœ‰ä¸»é¢˜æ•°æ®è¯»å–æµç¨‹:');
            addTestResult('  1. åœ¨RSC_Theme ColorInfo sheetä¸­æŸ¥æ‰¾ä¸»é¢˜è¡Œ');
            addTestResult('  2. ä½¿ç”¨colorInfoFieldMappingè¯»å–BallSpecå­—æ®µå€¼');
            addTestResult('  3. å°†è¯»å–çš„å€¼è®¾ç½®åˆ°UIè¾“å…¥æ¡†ä¸­');
            addTestResult('  4. æ›´æ–°BallSpecé¢œè‰²é¢„è§ˆ');

            addTestResult('ğŸ”§ ä¿®å¤å‰åå¯¹æ¯”:');
            addTestResult('  âŒ ä¿®å¤å‰: loadExistingColorInfoConfigç¼ºå°‘BallSpecå­—æ®µæ˜ å°„');
            addTestResult('  âŒ ä¿®å¤å‰: æ›´æ–°ç°æœ‰ä¸»é¢˜æ—¶æ— æ³•è¯»å–BallSpecç°æœ‰å€¼');
            addTestResult('  âœ… ä¿®å¤å: colorInfoFieldMappingåŒ…å«å®Œæ•´çš„BallSpecå­—æ®µ');
            addTestResult('  âœ… ä¿®å¤å: æ›´æ–°ç°æœ‰ä¸»é¢˜æ—¶æ­£ç¡®æ˜¾ç¤ºBallSpecå½“å‰å€¼');

            addTestResult('ğŸ¯ å­—æ®µæ˜ å°„ä¸€è‡´æ€§éªŒè¯:');
            addTestResult('  âœ… getLastThemeColorInfoConfig: åŒ…å«BallSpecå­—æ®µ');
            addTestResult('  âœ… applyColorInfoConfigToRow: åŒ…å«BallSpecå­—æ®µ');
            addTestResult('  âœ… loadExistingColorInfoConfig: åŒ…å«BallSpecå­—æ®µ (å·²ä¿®å¤)');
            addTestResult('  âœ… æ‰€æœ‰å‡½æ•°çš„å­—æ®µæ˜ å°„ç°åœ¨å®Œå…¨ä¸€è‡´');

            addTestResult('âœ… ç°æœ‰ä¸»é¢˜æ•°æ®è¯»å–åŠŸèƒ½æµ‹è¯•å®Œæˆ');
            showStatus('ç°æœ‰ä¸»é¢˜æ•°æ®è¯»å–åŠŸèƒ½æµ‹è¯•å®Œæˆ', 'success');
        }

        // æµ‹è¯•æ‰€æœ‰BallSpecåŠŸèƒ½
        function testAllBallSpecFeatures() {
            addTestResult('ğŸš€ å¼€å§‹å®Œæ•´BallSpecåŠŸèƒ½éªŒè¯æµ‹è¯•...');
            testBallSpecUI();
            setTimeout(() => testFeatureComparison(), 500);
            setTimeout(() => testDataCollection(), 1000);
            setTimeout(() => testDataApplication(), 1500);
            setTimeout(() => testValidation(), 2000);
            setTimeout(() => testDefaultValues(), 2500);
            setTimeout(() => testExistingThemeDataReading(), 3000);
            setTimeout(() => testColorPreview(), 3500);
            setTimeout(() => {
                addTestResult('âœ… æ‰€æœ‰BallSpecåŠŸèƒ½éªŒè¯æµ‹è¯•å®Œæˆï¼');
                addTestResult('ğŸ¯ BallSpecé’»çŸ³é«˜å…‰é¢œè‰²åŠŸèƒ½å·²å®Œå…¨é›†æˆ');
                addTestResult('ğŸ¯ UIç•Œé¢ã€æ•°æ®å¤„ç†ã€éªŒè¯ã€é»˜è®¤å€¼ã€é¢œè‰²é¢„è§ˆå…¨éƒ¨æ­£å¸¸');
                addTestResult('ğŸ¯ ç°æœ‰ä¸»é¢˜æ•°æ®è¯»å–é—®é¢˜å·²ä¿®å¤ï¼Œå­—æ®µæ˜ å°„å®Œå…¨ä¸€è‡´');
                addTestResult('ğŸ¯ æ–°å»ºå’Œæ›´æ–°ä¸»é¢˜æ—¶BallSpecé…ç½®éƒ½èƒ½æ­£ç¡®ä¿å­˜åˆ°Excelæ–‡ä»¶');
                showStatus('æ‰€æœ‰BallSpecåŠŸèƒ½éªŒè¯æµ‹è¯•å®Œæˆ', 'success');
            }, 4000);
        }

        // æ¸…é™¤ç»“æœ
        function clearResults() {
            testResults = [];
            document.getElementById('testResults').innerHTML = 'æµ‹è¯•ç»“æœå·²æ¸…é™¤';
            showStatus('ç­‰å¾…æµ‹è¯•...', 'info');
        }
    </script>
</body>
</html>
