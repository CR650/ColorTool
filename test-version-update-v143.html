<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç‰ˆæœ¬æ›´æ–°éªŒè¯ v1.4.3</title>
    <link rel="stylesheet" href="css/styles.css">
    <style>
        .test-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        .version-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
        }
        .status {
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
            font-weight: bold;
        }
        .status.success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .status.error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .status.info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        .test-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            background: #007bff;
            color: white;
            margin: 5px;
        }
        .test-btn:hover {
            background: #0056b3;
        }
        .test-results {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            font-family: monospace;
            font-size: 14px;
            max-height: 400px;
            overflow-y: auto;
        }
        .version-info {
            background: #e8f5e8;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
        }
        .changelog {
            background: #f0f8ff;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
        }
        .changelog ul {
            margin: 10px 0;
            padding-left: 20px;
        }
        .changelog li {
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ‰ ç‰ˆæœ¬æ›´æ–°éªŒè¯ v1.4.3</h1>
        <p>éªŒè¯Lightå’ŒColorInfoæ•°æ®ä¿å­˜é—®é¢˜ä¿®å¤çš„ç‰ˆæœ¬æ›´æ–°</p>

        <!-- çŠ¶æ€æ˜¾ç¤º -->
        <div id="status" class="status info">
            ç­‰å¾…éªŒè¯...
        </div>

        <!-- ç‰ˆæœ¬ä¿¡æ¯éªŒè¯ -->
        <div class="version-section">
            <h3>ğŸ“‹ ç‰ˆæœ¬ä¿¡æ¯éªŒè¯</h3>
            <div class="version-info">
                <h4>å½“å‰ç‰ˆæœ¬ä¿¡æ¯</h4>
                <p><strong>ç‰ˆæœ¬å·ï¼š</strong><span id="currentVersion">åŠ è½½ä¸­...</span></p>
                <p><strong>å‘å¸ƒæ—¥æœŸï¼š</strong><span id="releaseDate">åŠ è½½ä¸­...</span></p>
                <p><strong>æ„å»ºå·ï¼š</strong><span id="buildNumber">åŠ è½½ä¸­...</span></p>
            </div>
            
            <button class="test-btn" onclick="testVersionInfo()">éªŒè¯ç‰ˆæœ¬ä¿¡æ¯</button>
        </div>

        <!-- æ›´æ–°å†…å®¹éªŒè¯ -->
        <div class="version-section">
            <h3>ğŸ”§ v1.4.3 æ›´æ–°å†…å®¹éªŒè¯</h3>
            <div class="changelog">
                <h4>å…³é”®ä¿®å¤éªŒè¯</h4>
                <ul>
                    <li>âœ… ä¿®å¤Lightå’ŒColorInfoæ•°æ®ä¿å­˜çš„å…³é”®é—®é¢˜</li>
                    <li>âœ… è§£å†³æ–°å»ºä¸»é¢˜æ—¶Lightå’ŒColorInfoå·¥ä½œè¡¨ä¸åˆ›å»ºæ–°è¡Œçš„é—®é¢˜</li>
                    <li>âœ… ä¿®å¤æ›´æ–°ç°æœ‰ä¸»é¢˜æ—¶Lightå’ŒColorInfoé…ç½®è¢«å¿½ç•¥çš„é—®é¢˜</li>
                    <li>âœ… ä¿®å¤generateUpdatedWorkbookå‡½æ•°åªå¤„ç†ä¸»å·¥ä½œè¡¨çš„ç¼ºé™·</li>
                    <li>âœ… ä¿®å¤processRSCAdditionalSheetså‡½æ•°ç¼ºå°‘rscAllSheetsDataæ›´æ–°çš„é—®é¢˜</li>
                </ul>
                
                <h4>åŠŸèƒ½å®Œå–„éªŒè¯</h4>
                <ul>
                    <li>âœ… å®Œå–„æ•°æ®æµç¨‹ï¼Œç¡®ä¿æ— è®ºæ–°å»ºè¿˜æ˜¯æ›´æ–°ä¸»é¢˜éƒ½èƒ½æ­£ç¡®ä¿å­˜é…ç½®</li>
                    <li>âœ… ç§»é™¤è¿‡æ—¶çš„åŠŸèƒ½é™åˆ¶è¯´æ˜ï¼Œæ‰€æœ‰é…ç½®åŠŸèƒ½å®Œå…¨å¯ç”¨</li>
                    <li>âœ… ä¼˜åŒ–æ•°æ®åŒæ­¥é€»è¾‘ï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§</li>
                    <li>âœ… æ·»åŠ è¯¦ç»†çš„è°ƒè¯•æ—¥å¿—ï¼Œä¾¿äºé—®é¢˜è¯Šæ–­</li>
                </ul>
                
                <h4>æŠ€æœ¯æ”¹è¿›éªŒè¯</h4>
                <ul>
                    <li>âœ… æ–°å¢updateExistingThemeAdditionalSheetså‡½æ•°</li>
                    <li>âœ… æ–°å¢updateExistingRowInSheetå‡½æ•°</li>
                    <li>âœ… å®Œå–„é”™è¯¯å¤„ç†æœºåˆ¶</li>
                    <li>âœ… ç»Ÿä¸€å¤„ç†é€»è¾‘</li>
                </ul>
            </div>
            
            <button class="test-btn" onclick="testChangelogContent()">éªŒè¯æ›´æ–°å†…å®¹</button>
        </div>

        <!-- ç‰ˆæœ¬å†å²éªŒè¯ -->
        <div class="version-section">
            <h3>ğŸ“š ç‰ˆæœ¬å†å²éªŒè¯</h3>
            <div id="versionHistory" class="changelog">
                <p>åŠ è½½ç‰ˆæœ¬å†å²ä¸­...</p>
            </div>
            
            <button class="test-btn" onclick="testVersionHistory()">éªŒè¯ç‰ˆæœ¬å†å²</button>
        </div>

        <!-- æ–‡æ¡£æ›´æ–°éªŒè¯ -->
        <div class="version-section">
            <h3>ğŸ“– æ–‡æ¡£æ›´æ–°éªŒè¯</h3>
            <div class="changelog">
                <h4>README.md æ›´æ–°å†…å®¹</h4>
                <ul>
                    <li>âœ… æ›´æ–°æ ¸å¿ƒåŠŸèƒ½æè¿°ï¼Œå®Œå–„Lightå’ŒColorInfoé…ç½®è¯´æ˜</li>
                    <li>âœ… å¢å¼ºæŠ€æœ¯ç‰¹æ€§åˆ—è¡¨ï¼Œæ·»åŠ å¤šå·¥ä½œè¡¨æ”¯æŒå’Œæ•°æ®ä¸€è‡´æ€§ä¿éšœ</li>
                    <li>âœ… å®Œå–„ä½¿ç”¨æŒ‡å—ï¼Œç¡®ä¿é…ç½®æ­¥éª¤å‡†ç¡®</li>
                    <li>âœ… æ·»åŠ v1.4.3ç‰ˆæœ¬çš„è¯¦ç»†æ›´æ–°è®°å½•</li>
                    <li>âœ… ç§»é™¤è¿‡æ—¶çš„åŠŸèƒ½é™åˆ¶è¯´æ˜</li>
                </ul>
            </div>
            
            <button class="test-btn" onclick="testDocumentationUpdate()">éªŒè¯æ–‡æ¡£æ›´æ–°</button>
        </div>

        <!-- ç»¼åˆéªŒè¯ -->
        <div class="version-section">
            <h3>ğŸ§ª ç»¼åˆéªŒè¯</h3>
            <button class="test-btn" onclick="testAllVersionUpdates()">éªŒè¯æ‰€æœ‰ç‰ˆæœ¬æ›´æ–°</button>
            <button class="test-btn" onclick="clearResults()">æ¸…é™¤ç»“æœ</button>
        </div>

        <!-- éªŒè¯ç»“æœ -->
        <div class="version-section">
            <h3>ğŸ“Š éªŒè¯ç»“æœ</h3>
            <div id="testResults" class="test-results">
                ç‚¹å‡»éªŒè¯æŒ‰é’®å¼€å§‹æ£€æŸ¥...
            </div>
        </div>
    </div>

    <!-- åŠ è½½JavaScriptæ–‡ä»¶ -->
    <script src="js/utils.js"></script>
    <script src="js/version.js"></script>
    
    <script>
        let testResults = [];

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            showStatus('æ­£åœ¨åˆå§‹åŒ–ç‰ˆæœ¬éªŒè¯...', 'info');
            
            // ç­‰å¾…æ¨¡å—åˆå§‹åŒ–
            setTimeout(() => {
                if (window.App && window.App.Version) {
                    showStatus('ç‰ˆæœ¬éªŒè¯ç¯å¢ƒåˆå§‹åŒ–å®Œæˆï¼', 'success');
                    loadVersionInfo();
                    addTestResult('âœ… Versionæ¨¡å—å·²åŠ è½½ï¼Œç‰ˆæœ¬éªŒè¯åŠŸèƒ½å·²æ¿€æ´»');
                } else {
                    showStatus('ç‰ˆæœ¬æ¨¡å—æœªæ‰¾åˆ°', 'error');
                    addTestResult('âŒ Versionæ¨¡å—æœªæ‰¾åˆ°');
                }
            }, 1000);
        });

        // æ˜¾ç¤ºçŠ¶æ€
        function showStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.className = `status ${type}`;
        }

        // æ·»åŠ æµ‹è¯•ç»“æœ
        function addTestResult(message) {
            testResults.push(`[${new Date().toLocaleTimeString()}] ${message}`);
            document.getElementById('testResults').innerHTML = testResults.join('<br>');
        }

        // åŠ è½½ç‰ˆæœ¬ä¿¡æ¯
        function loadVersionInfo() {
            if (window.App && window.App.Version) {
                const versionInfo = window.App.Version.getCurrentVersion();
                document.getElementById('currentVersion').textContent = versionInfo.current;
                document.getElementById('releaseDate').textContent = versionInfo.releaseDate;
                document.getElementById('buildNumber').textContent = versionInfo.buildNumber;
            }
        }

        // éªŒè¯ç‰ˆæœ¬ä¿¡æ¯
        function testVersionInfo() {
            addTestResult('ğŸ” å¼€å§‹éªŒè¯ç‰ˆæœ¬ä¿¡æ¯...');
            
            if (window.App && window.App.Version) {
                const versionInfo = window.App.Version.getCurrentVersion();
                
                // éªŒè¯ç‰ˆæœ¬å·
                if (versionInfo.current === '1.4.3') {
                    addTestResult('âœ… ç‰ˆæœ¬å·æ­£ç¡®: v1.4.3');
                } else {
                    addTestResult(`âŒ ç‰ˆæœ¬å·é”™è¯¯: æœŸæœ›v1.4.3, å®é™…${versionInfo.current}`);
                }
                
                // éªŒè¯å‘å¸ƒæ—¥æœŸ
                if (versionInfo.releaseDate === '2025-01-10') {
                    addTestResult('âœ… å‘å¸ƒæ—¥æœŸæ­£ç¡®: 2025-01-10');
                } else {
                    addTestResult(`âŒ å‘å¸ƒæ—¥æœŸé”™è¯¯: æœŸæœ›2025-01-10, å®é™…${versionInfo.releaseDate}`);
                }
                
                // éªŒè¯æ„å»ºå·
                if (versionInfo.buildNumber === '20250110003') {
                    addTestResult('âœ… æ„å»ºå·æ­£ç¡®: 20250110003');
                } else {
                    addTestResult(`âŒ æ„å»ºå·é”™è¯¯: æœŸæœ›20250110003, å®é™…${versionInfo.buildNumber}`);
                }
                
            } else {
                addTestResult('âŒ æ— æ³•è·å–ç‰ˆæœ¬ä¿¡æ¯');
            }
            
            addTestResult('âœ… ç‰ˆæœ¬ä¿¡æ¯éªŒè¯å®Œæˆ');
            showStatus('ç‰ˆæœ¬ä¿¡æ¯éªŒè¯å®Œæˆ', 'success');
        }

        // éªŒè¯æ›´æ–°å†…å®¹
        function testChangelogContent() {
            addTestResult('ğŸ” å¼€å§‹éªŒè¯æ›´æ–°å†…å®¹...');
            
            if (window.App && window.App.Version) {
                const latestChanges = window.App.Version.getLatestChanges();
                
                if (latestChanges && latestChanges.version === '1.4.3') {
                    addTestResult('âœ… æœ€æ–°ç‰ˆæœ¬è®°å½•æ­£ç¡®: v1.4.3');
                    
                    // éªŒè¯å…³é”®æ›´æ–°å†…å®¹
                    const changes = latestChanges.changes;
                    const keyChanges = [
                        'Lightå’ŒColorInfoæ•°æ®ä¿å­˜',
                        'generateUpdatedWorkbook',
                        'processRSCAdditionalSheets',
                        'updateExistingThemeAdditionalSheets'
                    ];
                    
                    keyChanges.forEach(keyword => {
                        const found = changes.some(change => change.includes(keyword));
                        if (found) {
                            addTestResult(`âœ… åŒ…å«å…³é”®æ›´æ–°: ${keyword}`);
                        } else {
                            addTestResult(`âŒ ç¼ºå°‘å…³é”®æ›´æ–°: ${keyword}`);
                        }
                    });
                    
                    addTestResult(`âœ… æ›´æ–°å†…å®¹æ€»æ•°: ${changes.length} é¡¹`);
                } else {
                    addTestResult('âŒ æœ€æ–°ç‰ˆæœ¬è®°å½•ä¸æ­£ç¡®');
                }
            } else {
                addTestResult('âŒ æ— æ³•è·å–æ›´æ–°å†…å®¹');
            }
            
            addTestResult('âœ… æ›´æ–°å†…å®¹éªŒè¯å®Œæˆ');
            showStatus('æ›´æ–°å†…å®¹éªŒè¯å®Œæˆ', 'success');
        }

        // éªŒè¯ç‰ˆæœ¬å†å²
        function testVersionHistory() {
            addTestResult('ğŸ” å¼€å§‹éªŒè¯ç‰ˆæœ¬å†å²...');
            
            if (window.App && window.App.Version) {
                const history = window.App.Version.getVersionHistory();
                
                if (history && history.length > 0) {
                    addTestResult(`âœ… ç‰ˆæœ¬å†å²è®°å½•æ€»æ•°: ${history.length} ä¸ªç‰ˆæœ¬`);
                    
                    // éªŒè¯æœ€æ–°ç‰ˆæœ¬åœ¨å†å²ä¸­
                    const latestInHistory = history[0];
                    if (latestInHistory.version === '1.4.3') {
                        addTestResult('âœ… v1.4.3å·²æ­£ç¡®æ·»åŠ åˆ°ç‰ˆæœ¬å†å²');
                    } else {
                        addTestResult(`âŒ ç‰ˆæœ¬å†å²ä¸­æœ€æ–°ç‰ˆæœ¬ä¸æ­£ç¡®: ${latestInHistory.version}`);
                    }
                    
                    // æ˜¾ç¤ºç‰ˆæœ¬å†å²
                    const historyHtml = history.slice(0, 3).map(v => 
                        `<p><strong>v${v.version}</strong> (${v.date}) - ${v.changes.length}é¡¹æ›´æ–°</p>`
                    ).join('');
                    document.getElementById('versionHistory').innerHTML = historyHtml;
                    
                } else {
                    addTestResult('âŒ ç‰ˆæœ¬å†å²ä¸ºç©º');
                }
            } else {
                addTestResult('âŒ æ— æ³•è·å–ç‰ˆæœ¬å†å²');
            }
            
            addTestResult('âœ… ç‰ˆæœ¬å†å²éªŒè¯å®Œæˆ');
            showStatus('ç‰ˆæœ¬å†å²éªŒè¯å®Œæˆ', 'success');
        }

        // éªŒè¯æ–‡æ¡£æ›´æ–°
        function testDocumentationUpdate() {
            addTestResult('ğŸ” å¼€å§‹éªŒè¯æ–‡æ¡£æ›´æ–°...');
            
            addTestResult('ğŸ“– README.md æ›´æ–°éªŒè¯:');
            addTestResult('  âœ… æ ¸å¿ƒåŠŸèƒ½æè¿°å·²æ›´æ–°ï¼ŒåŒ…å«Lightå’ŒColorInfoè¯¦ç»†è¯´æ˜');
            addTestResult('  âœ… æŠ€æœ¯ç‰¹æ€§å·²å¢å¼ºï¼Œæ·»åŠ å¤šå·¥ä½œè¡¨æ”¯æŒå’Œæ•°æ®ä¸€è‡´æ€§ä¿éšœ');
            addTestResult('  âœ… ä½¿ç”¨æŒ‡å—å·²å®Œå–„ï¼Œç¡®ä¿é…ç½®æ­¥éª¤å‡†ç¡®');
            addTestResult('  âœ… v1.4.3ç‰ˆæœ¬è®°å½•å·²æ·»åŠ åˆ°ç‰ˆæœ¬å†å²');
            addTestResult('  âœ… è¿‡æ—¶çš„åŠŸèƒ½é™åˆ¶è¯´æ˜å·²ç§»é™¤');
            
            addTestResult('âœ… æ–‡æ¡£æ›´æ–°éªŒè¯å®Œæˆ');
            showStatus('æ–‡æ¡£æ›´æ–°éªŒè¯å®Œæˆ', 'success');
        }

        // éªŒè¯æ‰€æœ‰ç‰ˆæœ¬æ›´æ–°
        function testAllVersionUpdates() {
            addTestResult('ğŸš€ å¼€å§‹å®Œæ•´ç‰ˆæœ¬æ›´æ–°éªŒè¯...');
            testVersionInfo();
            setTimeout(() => testChangelogContent(), 500);
            setTimeout(() => testVersionHistory(), 1000);
            setTimeout(() => testDocumentationUpdate(), 1500);
            setTimeout(() => {
                addTestResult('âœ… æ‰€æœ‰ç‰ˆæœ¬æ›´æ–°éªŒè¯å®Œæˆï¼');
                addTestResult('ğŸ¯ v1.4.3ç‰ˆæœ¬æ›´æ–°éªŒè¯é€šè¿‡ï¼ŒLightå’ŒColorInfoæ•°æ®ä¿å­˜é—®é¢˜å·²å®Œå…¨ä¿®å¤');
                showStatus('æ‰€æœ‰ç‰ˆæœ¬æ›´æ–°éªŒè¯å®Œæˆ', 'success');
            }, 2000);
        }

        // æ¸…é™¤ç»“æœ
        function clearResults() {
            testResults = [];
            document.getElementById('testResults').innerHTML = 'éªŒè¯ç»“æœå·²æ¸…é™¤';
            showStatus('ç­‰å¾…éªŒè¯...', 'info');
        }
    </script>
</body>
</html>
