# 📁 ColorTool 文件夹选择功能使用指南

## 🎯 功能概述

ColorTool 现已支持**一键文件夹选择**功能！用户可以直接选择Unity项目的xlsx文件夹，系统将自动定位并加载RSC_Theme.xls和UGCTheme.xls文件，大大简化操作流程。

## ✨ 主要优势

### 🚀 操作简化
- **从2步简化为1步**：无需分别选择两个文件，一次选择文件夹即可
- **自动文件定位**：智能识别并加载目标文件
- **减少错误率**：避免用户选错文件或路径

### 🔧 技术先进
- **File System Access API**：使用最新的浏览器API
- **直接文件保存**：支持直接覆盖原文件，无需手动替换
- **权限管理**：自动请求和管理文件读写权限

### 🌐 兼容性保障
- **渐进式增强**：现有功能完全保留
- **浏览器降级**：不支持的浏览器自动使用传统方式
- **用户友好**：清晰的兼容性提示和操作指导

## 🖥️ 浏览器支持

### ✅ 完全支持
- **Chrome 86+**：推荐使用，功能最完整
- **Edge 86+**：推荐使用，功能最完整

### ⚠️ 部分支持
- **Firefox**：不支持文件夹选择，可使用传统文件选择
- **Safari**：不支持文件夹选择，可使用传统文件选择

### 📱 移动端
- 移动端浏览器支持有限，建议使用桌面版浏览器

## 📋 使用步骤

### 方式1：文件夹选择（推荐）

1. **打开应用**
   - 使用Chrome 86+或Edge 86+浏览器
   - 访问ColorTool应用

2. **选择文件夹**
   - 点击"📁 选择Unity项目文件夹"按钮
   - 在弹出的文件夹选择器中，导航到Unity项目路径
   - 选择`rs_ugc2\RS_UGC_Unity_2021.3.31\Tools\xlsx\`文件夹

3. **自动加载**
   - 系统自动扫描文件夹内容
   - 自动定位RSC_Theme.xls和UGCTheme.xls文件
   - 自动请求文件读写权限并加载数据

4. **确认结果**
   - 查看文件夹选择结果显示
   - 确认找到的文件状态
   - 开始使用颜色主题处理功能

### 方式2：分别选择文件（兼容模式）

1. **选择RSC_Theme文件**
   - 点击"🎯 选择RSC_Theme文件并启用直接保存"
   - 选择RSC_Theme.xls文件

2. **选择UGCTheme文件**
   - 点击"🎯 选择UGCTheme文件并启用直接保存"
   - 选择UGCTheme.xls文件

3. **开始处理**
   - 两个文件都加载完成后即可开始处理

## 🔍 功能特性

### 智能文件识别
- 自动扫描文件夹中的.xls文件
- 精确匹配RSC_Theme.xls和UGCTheme.xls
- 验证文件格式和完整性

### 权限管理
- 自动请求文件读写权限
- 安全的权限验证机制
- 权限失败时的友好提示

### 错误处理
- 完善的错误捕获和处理
- 用户友好的错误提示
- 自动降级到兼容模式

### 状态反馈
- 实时的操作状态显示
- 清晰的文件加载进度
- 详细的结果信息展示

## 🛠️ 技术实现

### 核心模块
- `unityProjectFolderManager.js`：文件夹管理核心逻辑
- `themeManager.js`：集成文件夹选择功能
- 渐进式增强设计，保持向后兼容

### API使用
- `showDirectoryPicker()`：文件夹选择
- `FileSystemDirectoryHandle`：文件夹操作
- `FileSystemFileHandle`：文件读写操作

### 安全考虑
- HTTPS环境要求
- 用户主动授权
- 最小权限原则

## 🐛 故障排除

### 文件夹选择失败
**问题**：点击按钮后没有反应或报错
**解决方案**：
1. 确认使用Chrome 86+或Edge 86+
2. 确保在HTTPS环境下使用
3. 检查浏览器是否允许文件系统访问

### 文件未找到
**问题**：选择文件夹后提示文件未找到
**解决方案**：
1. 确认选择的是正确的xlsx文件夹
2. 检查文件夹中是否包含RSC_Theme.xls或UGCTheme.xls
3. 确认文件名大小写正确

### 权限被拒绝
**问题**：提示权限被拒绝
**解决方案**：
1. 重新选择文件夹并允许权限
2. 检查文件是否被其他程序占用
3. 尝试以管理员身份运行浏览器

### 兼容性问题
**问题**：浏览器不支持文件夹选择
**解决方案**：
1. 升级到Chrome 86+或Edge 86+
2. 使用"分别选择文件"功能
3. 参考浏览器兼容性说明

## 📞 技术支持

如果遇到问题，请：
1. 查看浏览器控制台错误信息
2. 确认浏览器版本和兼容性
3. 尝试使用兼容模式
4. 联系技术支持团队

## 🔄 版本历史

### v1.0.0 (2025-09-05)
- ✨ 新增文件夹选择功能
- 🔧 集成File System Access API
- 🎨 优化用户界面和交互体验
- 🛡️ 完善错误处理和兼容性支持
- 📱 添加响应式设计支持

---

**注意**：此功能需要现代浏览器支持，建议使用最新版本的Chrome或Edge浏览器以获得最佳体验。
