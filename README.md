# 颜色主题管理工具 (ColorTool Connect)

一个专为Unity项目设计的颜色主题配置管理工具，支持Excel文件的颜色数据处理和主题文件更新。

## 🎯 项目概述

本工具旨在简化Unity项目中颜色主题的管理流程，通过Web界面实现颜色配置的导入、处理和更新，支持RSC_Theme.xls和UGCTheme.xls文件的自动化处理。

## ✨ 主要功能

### 核心功能
- **🎯 双映射模式**：支持JSON间接映射和直接映射两种模式，自动检测源数据文件结构
  - **JSON间接映射**：通过配置文件定义复杂的映射关系（如P11→P3）
  - **直接映射**：源数据包含Color工作表时，直接进行字段对字段的映射
- **颜色数据处理**：解析Excel源数据文件中的完整配色表，提供详细的文件选择结果显示
- **主题文件管理**：支持RSC_Theme.xls、UGCTheme.xls和AllObstacle.xls文件的读取和更新
- **🆕 AllObstacle.xls自动处理**：全新系列主题创建时自动管理AllObstacle文件
  - **智能触发**：仅在创建全新系列主题时自动处理，避免不必要的操作
  - **自动数据填充**：在Info工作表中自动添加新记录，包含ID、基础名称、多语言ID、Sort和isFilter字段
  - **格式兼容**：优先保存为XLS格式确保与Java工具兼容
- **Light配置管理**：RSC_Theme Light sheet的光照参数可视化配置，支持明度偏移、高光等级、光泽度和高光颜色设置
- **ColorInfo配置管理**：RSC_Theme ColorInfo sheet的颜色和雾效参数配置，支持钻石颜色、反光颜色、高光颜色、远景雾颜色和雾效距离设置
- **🆕 FloodLight配置管理**：RSC_Theme FloodLight sheet的泛光参数可视化配置，支持泛光颜色、临界点、强度和开关设置
- **🆕 VolumetricFog配置管理**：RSC_Theme VolumetricFog sheet的体积雾参数可视化配置，支持体积雾颜色、尺寸、效果和开关设置
- **UGC图案配置**：UGCTheme图案和边框的可视化选择器，支持地板、易碎块、跳板的图案和边框选择
- **数据映射**：智能匹配和映射颜色数据到目标主题文件
- **文件保存**：支持直接覆盖原文件或下载更新后的文件，确保所有配置数据正确保存
- **文件选择反馈**：实时显示文件选择结果，包括文件名、大小、选择时间和数据统计

### 技术特性
- **File System Access API**：在支持的浏览器中实现直接文件操作
- **拖拽上传**：支持文件拖拽上传，提升用户体验
- **数据预览**：实时预览Excel文件内容和Sheet数据
- **实时验证**：数值输入的实时范围检查和自动修正
- **可视化配置**：图案选择器和颜色选择器的直观操作界面
- **多工作表支持**：完整支持RSC_Theme文件的Color、Light、ColorInfo等多个工作表
- **智能默认值**：新建主题时自动使用表中最后一个主题的配置作为默认值
- **数据一致性保障**：确保内存数据与Excel文件数据完全同步
- **响应式设计**：适配桌面和移动设备
- **错误处理**：完善的错误提示和异常处理机制
- **文件状态反馈**：实时显示文件选择状态和详细信息
- **简洁界面设计**：优化的UI布局，移除冗余信息显示

## 🚀 快速开始

### 在线使用
访问 [GitHub Pages 部署地址](https://your-username.github.io/ColorToolConnectRC/) 直接使用。

### 本地部署

#### 环境要求
- **浏览器**：Chrome 88+、Edge 88+、Firefox 90+、Safari 14+
- **文件格式**：Excel文件(.xls, .xlsx)
- **运行环境**：推荐使用HTTP服务器访问（避免CORS限制）

#### 安装步骤
1. 克隆项目到本地
```bash
git clone https://github.com/your-username/ColorToolConnectRC.git
cd ColorToolConnectRC
```

2. 启动项目

**方式1：便捷启动（推荐）**
- 双击运行 `start_server.bat` 文件
- 脚本会自动启动HTTP服务器并打开浏览器

**方式2：手动启动**
```bash
# 使用Python
python -m http.server 8000

# 使用Node.js
npx serve .

# 然后访问 http://localhost:8000
```

**方式3：直接打开（功能受限）**
- 直接双击 `index.html` 文件
- ⚠️ **注意**：JSON映射模式会受到CORS限制，建议使用HTTP服务器

#### CORS问题说明
如果直接打开HTML文件遇到CORS错误，请参考 `CORS问题解决方案.md` 文档。

## 📖 使用指南

### 基本使用流程
1. **选择源数据文件**：上传包含完整配色表或Color工作表的Excel文件，系统将自动检测映射模式
2. **选择Unity项目文件夹**：选择包含RSC_Theme.xls、UGCTheme.xls和AllObstacle.xls文件的Unity项目文件夹
3. **输入主题名称**：指定要创建或更新的主题名称
   - **全新系列主题**：如"测试主题1"（现有主题中没有"测试主题"系列），将自动处理AllObstacle.xls
   - **同系列主题**：如"赛博3"（已有"赛博1"、"赛博2"），不会处理AllObstacle.xls
4. **配置主题参数**：
   - **UGC图案配置**：选择地板、玻璃、跳板的图案和边框，支持可视化图案选择器
   - **Light光照配置**：设置明度偏移、高光等级、光泽度和高光颜色
   - **ColorInfo颜色配置**：设置钻石颜色、反光颜色、高光颜色、远景雾颜色和雾效距离
   - **透明度设置**：调整各元素的透明度值(0-100)
5. **处理数据**：点击处理按钮生成更新后的主题文件
6. **保存文件**：直接覆盖原文件或下载更新后的文件，系统将显示固定的操作路径指引

### Light配置详细说明
- **明度偏移设置**：
  - Max (顶面明度偏移)：范围 -255 到 255
  - Dark (侧面明度偏移)：范围 -255 到 255
  - Min (底面明度偏移)：范围 -255 到 255
- **高光参数配置**：
  - SpecularLevel (高光等级)：范围 0 到 1000，游戏中实际值为设置值÷100
  - Gloss (高光光泽度)：范围 10 到 1000，游戏中实际值为设置值÷100
- **高光颜色选择**：
  - 支持16进制颜色值输入 (如: FFFFFF)
  - 提供专业调色板进行可视化选择
  - 包含16种预设常用颜色快速选择

### ColorInfo配置详细说明
- **钻石颜色设置 (PickupDiff)**：
  - PickupDiffR、PickupDiffG、PickupDiffB：RGB值范围 0-255
  - 支持可视化颜色选择器，自动拆分为R、G、B三个数值
  - 实时颜色预览，显示RGB组合的实际效果
- **钻石反光颜色 (PickupRefl)**：
  - PickupReflR、PickupReflG、PickupReflB：RGB值范围 0-255
  - 控制钻石的反光颜色效果
- **钻石高光颜色 (BallSpec)**：
  - BallSpecR、BallSpecG、BallSpecB：RGB值范围 0-255
  - 支持可视化颜色选择器，自动拆分为R、G、B三个数值
  - 控制钻石的高光颜色效果，提供更丰富的视觉表现
- **远景雾颜色 (ForegroundFog)**：
  - ForegroundFogR、ForegroundFogG、ForegroundFogB：RGB值范围 0-255
  - 设置游戏中远景雾效的颜色
- **雾效距离参数**：
  - FogStart (雾开始距离)：范围 0-40
  - FogEnd (雾结束距离)：范围 0-90
  - 控制雾效的渐变范围和可见距离

### FloodLight配置详细说明
- **泛光颜色设置**：
  - Color (泛光颜色)：16进制颜色选择器，支持专业调色板
  - 与Light配置中的SpecularColor使用相同的处理方式
  - 实时颜色预览，显示选择的颜色效果
- **泛光参数配置**：
  - TippingPoint (临界点)：范围 0 到 5，支持一位小数（如：2.5）
  - Strength (强度)：范围 0 到 10，支持一位小数（如：7.8）
  - 数据转换：输入值 × 10 后存储到表中（因为表中数据格式为int）
  - 实时验证：自动验证范围并提供错误提示
- **泛光开关设置**：
  - IsOn (泛光是否默认开启)：醒目的toggle switch样式
  - JumpActiveIsLightOn (跳板踩踏态发光是否开启)：醒目的toggle switch样式
  - 数据格式：0（关闭）/ 1（开启）
- **自动字段处理**：
  - LightStrength (光照强度)：系统自动填充，固定值180
  - 用户无需配置，由系统自动处理

### VolumetricFog配置详细说明
- **体积雾颜色设置**：
  - Color (体积雾颜色)：16进制颜色选择器，支持专业调色板
  - 与FloodLight配置中的Color使用相同的处理方式
  - 实时颜色预览，显示选择的颜色效果
- **体积雾尺寸配置**：
  - X (宽度)：范围 0 到 100，整数输入（如：75）
  - Y (长度)：范围 0 到 100，整数输入（如：80）
  - Z (高度)：范围 0 到 100，整数输入（如：60）
  - 实时验证：自动验证范围并提供错误提示
- **体积雾效果配置**：
  - Density (浓淡)：范围 0 到 20，支持一位小数（如：15.5）
  - 数据转换：输入值 × 10 后存储到表中（因为表中数据格式为int）
  - Rotate (旋转角度)：范围 -90 到 90，整数输入（如：45）
  - 实时验证：自动验证范围和小数位数，超出范围时自动修正
- **体积雾开关设置**：
  - IsOn (体积雾是否默认开启)：醒目的toggle switch样式
  - 数据格式：0（关闭）/ 1（开启）
  - 与FloodLight开关保持一致的交互体验

### UGC图案配置详细说明
- **跳板边框图案选择**：
  - 支持可视化边框图案选择器，与地板边框保持一致的交互体验
  - 移除0/1限制，支持任意有效的边框图案ID
  - 输入框设置为只读，确保通过选择器设置有效值
- **玻璃透明度优化**：
  - 新建主题时默认透明度为50，提供更合理的初始值
  - 支持0-100范围的精确调整

### AllObstacle.xls处理详细说明
- **触发条件**：仅在创建全新系列主题时自动处理
  - 系统通过智能检测判断主题是否为全新系列
  - 利用现有的`getSmartMultiLanguageConfig()`函数进行主题类型检测
- **数据处理规则**：在Info工作表中自动添加新记录
  - **id列**：现有数据中id列的最大值+1
  - **notes列**：主题的基础名称（使用`extractThemeBaseName()`函数去除末尾数字）
  - **nameID列**：用户在多语言配置面板中输入的多语言ID
  - **Sort列**：现有数据中Sort列的最大值+1
  - **isFilter列**：固定填入数值1
- **数据行位置**：Info工作表的表头在第1行，数据从第6行开始
- **格式兼容性**：优先保存为XLS格式以确保与Java工具兼容
- **错误处理**：文件不存在、权限失败等情况不影响主流程

### 文件格式要求
- **源数据文件**：Excel格式(.xlsx, .xls)，包含"完整配色表"工作表
- **主题文件**：Unity项目中的RSC_Theme.xls、UGCTheme.xls和AllObstacle.xls文件
- **AllObstacle.xls结构**：必须包含Info工作表，且具有id、notes、nameID、Sort、isFilter列
- **输出格式**：统一使用.xls格式以确保与Unity工具兼容

### 浏览器兼容性
- **推荐浏览器**：Chrome 86+, Edge 86+ (支持File System Access API)
- **兼容浏览器**：Firefox, Safari (使用传统下载方式)
- **移动设备**：支持移动端浏览器访问

## 🏗️ 项目结构

```
ColorToolConnectRC/
├── index.html              # 主页面
├── css/
│   └── styles.css          # 样式文件
├── js/
│   ├── main.js            # 主模块
│   ├── version.js         # 版本管理
│   ├── utils.js           # 工具函数
│   ├── fileHandler.js     # 文件处理
│   ├── dataParser.js      # 数据解析
│   ├── tableRenderer.js   # 表格渲染
│   ├── exportUtils.js     # 导出工具
│   ├── themeManager.js    # 主题管理
│   ├── ugcPatternSelector.js # UGC图案选择器
│   ├── colorPicker.js     # 颜色选择器
│   ├── unityProjectFolderManager.js # Unity项目文件夹管理
│   ├── fileSystemAccess.js # 文件系统访问
│   └── enhancedFileManager.js # 增强文件管理
├── electron_app/          # Electron应用版本
├── python_backend/        # Python后端版本
└── README.md              # 项目文档
```

## 🔧 技术栈

### 前端技术
- **HTML5**：语义化标记和现代Web标准
- **CSS3**：响应式设计和现代样式
- **JavaScript ES6+**：模块化开发和现代语法
- **SheetJS (XLSX)**：Excel文件处理库

### 浏览器API
- **File System Access API**：直接文件操作
- **File API**：文件读取和处理
- **Drag and Drop API**：拖拽文件上传
- **Canvas API**：颜色选择器渐变绘制
- **LocalStorage API**：本地数据存储

### 开发工具
- **模块化架构**：清晰的代码组织结构
- **实时验证系统**：输入数据的即时验证和错误处理
- **事件驱动架构**：基于事件的模块间通信
- **错误处理**：完善的异常捕获和处理
- **调试支持**：详细的控制台日志输出

## 🎨 颜色通道映射逻辑

### 映射模式概述
本工具支持两种映射模式，系统会根据源数据文件结构自动检测并选择合适的模式：

#### 📋 JSON间接映射模式（第一优先级）
**触发条件**：源数据文件包含名为"完整配色表"的工作表

**工作原理**：
- **间接映射关系**：通过`XLS/对比.json`文件定义的映射关系进行颜色查找
- **复杂映射支持**：支持P11→P3、P15→P4等复杂的间接映射关系
- **严格验证**：对颜色值进行6位十六进制格式验证
- **配置灵活**：可通过修改JSON文件调整映射关系

#### 🎯 直接映射模式（第二优先级，v1.5.0新增）
**触发条件**：源数据文件包含名为"Color"的工作表（且没有"完整配色表"工作表）

**工作原理**：
- **直接字段对应**：颜色通道名称直接对应源数据中的列名
  - P1通道 → 直接查找源数据Color工作表中的P1列
  - G1通道 → 直接查找源数据Color工作表中的G1列
  - 支持任意P和G开头的字段（如P1-P49, G1-G7等）
- **简化验证**：只检查字段存在性和非空性，无需格式验证
- **灵活匹配**：只要字段名匹配且数据非空就直接使用
- **高效处理**：避免复杂的映射关系查找，直接进行字段匹配

**数据结构要求**：
```
Color工作表结构：
第一行（表头）：可包含任意字段，如 主要ID, 主体名称, G1, G2, G3, P1, P2, P3...
第二行（数据）：对应的颜色值（支持#RRGGBB或RRGGBB格式）
```

#### 🔄 检测优先级
1. **第一优先级**：检查"完整配色表"工作表 → JSON间接映射模式
2. **第二优先级**：检查"Color"工作表 → 直接映射模式
3. **默认情况**：都没有找到 → JSON间接映射模式（使用内置数据）

### JSON映射模式详细说明
本模式采用两阶段的颜色通道处理逻辑，确保数据映射的准确性和可控性：

#### 第一阶段：映射关系处理
- **基于映射文件**：根据`XLS/对比.json`文件中定义的映射关系进行颜色查找
- **间接映射示例**：
  - P11通道 → 映射到P3颜色代码 → 从源数据获取P3的颜色值
  - P15通道 → 映射到P4颜色代码 → 从源数据获取P4的颜色值
- **直接映射示例**：
  - P1通道 → 映射到P1颜色代码 → 从源数据获取P1的颜色值
  - G1通道 → 映射到G2颜色代码 → 从源数据获取G2的颜色值

#### 第二阶段：未映射通道处理
对于没有在映射文件中定义的颜色通道，系统采用以下逻辑：

1. **检查现有值**：检查RSC_Theme文件中该通道是否已有颜色值
2. **值有效性验证**：验证现有值是否为有效的6位十六进制颜色值
3. **处理策略**：
   - **如果现有值有效**：保持现有值不变
   - **如果现有值无效或为空**：设置为默认值FFFFFF（白色）

### P3和P4通道的特殊情况

#### 当前行为（设计如此）
- **P3通道**：没有直接映射关系，如果RSC_Theme文件中已有颜色值且有效，则保持现有值
- **P4通道**：没有直接映射关系，如果RSC_Theme文件中已有颜色值且有效，则保持现有值

#### 相关映射关系
- **P11通道**：通过映射关系获取源数据中P3颜色代码的值
- **P15通道**：通过映射关系获取源数据中P4颜色代码的值

#### 实际处理结果
```
源数据示例：
├── P3颜色代码: #FF0000 (红色)
├── P4颜色代码: #00FF00 (绿色)

RSC_Theme文件现有值：
├── P3列: 26191E (深绿色)
├── P4列: 32D9D1 (青色)

处理结果：
├── P11通道: FF0000 (从源数据P3颜色代码获取)
├── P15通道: 00FF00 (从源数据P4颜色代码获取)
├── P3通道:  26191E (保持RSC_Theme文件中的现有值)
├── P4通道:  32D9D1 (保持RSC_Theme文件中的现有值)
```

### 映射配置文件结构

#### 映射文件位置
- **文件路径**：`XLS/对比.json`
- **备用数据**：`js/themeManager.js`中的内置映射数据（向后兼容）

#### 映射关系示例
```json
{
  "RC现在的主题通道": "P11",
  "作用": "主动板颜色",
  "颜色代码": "P3"
}
```

#### 关键映射关系
- **P1 → P1**：地板基础颜色
- **P5 → P2**：跳板基础颜色
- **P11 → P3**：主动板颜色（间接映射）
- **P15 → P4**：被动板颜色（间接映射）
- **G1 → G2**：障碍物绿色通道
- **G2 → G3**：障碍物蓝色通道
- **G3 → G1**：障碍物红色通道

### 技术实现细节

#### 处理函数
- **`updateThemeColors()`**：执行映射关系处理
- **`processAllColorChannels()`**：处理未映射通道
- **`findColorValue()`**：在源数据中查找颜色值

#### 验证逻辑
```javascript
// 颜色值有效性检查
const cleanValue = currentValue.toString().trim().toUpperCase();
if (!/^[0-9A-F]{6}$/i.test(cleanValue)) {
    needsDefault = true;
}
```

#### 日志输出
系统会在控制台输出详细的处理日志：
```
✅ 成功更新: P11 = FF0000 (颜色代码: P3)
✅ 成功更新: P15 = 00FF00 (颜色代码: P4)
✅ 保持现有值: P3 = 26191E
✅ 保持现有值: P4 = 32D9D1
```

### 映射模式自动检测

#### 检测逻辑
系统在加载源数据文件时自动执行以下检测：

1. **检查工作表**：是否包含名为"Color"的工作表
2. **分析表头**：检查第一行是否包含直接映射字段（G1-G7, P1-P49）
3. **字段计数**：统计有效的直接映射字段数量
4. **模式判定**：字段数量≥5个时启用直接映射模式，否则使用JSON映射模式

#### UI指示器
- **映射模式指示器**：在源数据文件选择后显示检测到的映射模式
- **直接映射模式**：蓝色背景，显示"🎯 直接映射模式"和支持的字段数量
- **JSON映射模式**：黄色背景，显示"📋 JSON映射模式"和配置文件信息

### 自定义映射配置

#### JSON映射模式配置
1. **编辑JSON文件**：直接修改`XLS/对比.json`文件
2. **添加新映射**：在data数组中添加新的映射对象
3. **修改现有映射**：更改"RC现在的主题通道"或"颜色代码"字段
4. **删除映射**：从data数组中移除对应的映射对象

#### 直接映射模式配置
1. **调整源数据结构**：在Color工作表中添加或删除字段列
2. **字段命名规范**：使用G1-G7（装饰颜色）和P1-P49（主要颜色）格式
3. **数据格式**：颜色值支持#RRGGBB或RRGGBB格式

#### 映射配置示例
**JSON映射模式**：
```json
{
  "RC现在的主题通道": "P40",
  "作用": "新增颜色通道",
  "颜色代码": "P40"
}
```

**直接映射模式**：
```
Color工作表：
G1      G2      P1      P2      P40
FF0000  00FF00  0000FF  FFFF00  FF00FF
```

#### 配置生效
- **JSON映射**：修改JSON文件后刷新页面即可生效
- **直接映射**：修改源数据文件后重新选择文件即可生效
- **错误处理**：配置错误时自动回退到默认处理方式

#### 映射关系字段说明（JSON模式）
- **RC现在的主题通道**：目标通道名称（如P11、P15）
- **颜色代码**：源数据中的颜色代码（如P3、P4）
- **作用**：映射关系的说明（可选）

## 🐛 问题排查

### 常见问题

#### CORS相关问题
1. **JSON映射文件无法读取**：
   - **现象**：控制台显示"Access to fetch at 'file://...' blocked by CORS policy"
   - **原因**：直接打开HTML文件使用file://协议，浏览器阻止访问其他本地文件
   - **解决方案**：
     - 推荐：双击 `start_server.bat` 启动HTTP服务器
     - 或手动运行：`python -m http.server 8000`
     - 然后访问：`http://localhost:8000`

#### 映射模式问题
2. **映射模式检测错误**：
   - **现象**：期望直接映射但显示JSON映射模式
   - **检查**：确保源数据文件包含名为"Color"的工作表
   - **优先级**：完整配色表工作表 > Color工作表 > 默认JSON模式

#### 文件格式问题
3. **文件格式错误**：确保使用.xls格式的主题文件
4. **权限问题**：在Chrome/Edge中允许文件访问权限
5. **数据不匹配**：检查源数据文件工作表结构
6. **浏览器兼容**：使用推荐的浏览器版本

### 错误代码
- **FileFormatError**：文件格式不支持
- **PermissionError**：文件访问权限不足
- **DataMappingError**：数据映射失败
- **NetworkError**：网络连接问题
- **CORSError**：跨域资源访问被阻止

### 功能对比表

| 访问方式 | JSON映射模式 | 直接映射模式 | 文件保存 | 推荐度 |
|---------|-------------|-------------|---------|--------|
| `file://`直接打开 | ❌ CORS限制 | ✅ 正常工作 | ✅ 正常 | ⚠️ 功能受限 |
| HTTP服务器访问 | ✅ 完全正常 | ✅ 完全正常 | ✅ 正常 | ✅ **强烈推荐** |

## 🤝 贡献指南

欢迎提交Issue和Pull Request来改进项目。

### 开发环境设置
1. Fork项目到你的GitHub账户
2. 创建功能分支：`git checkout -b feature/new-feature`
3. 提交更改：`git commit -am 'Add new feature'`
4. 推送分支：`git push origin feature/new-feature`
5. 创建Pull Request

### 代码规范
- 使用ES6+语法
- 遵循模块化开发原则
- 添加适当的注释和文档
- 确保代码通过测试

## 📄 许可证

本项目采用 MIT 许可证 - 查看 [LICENSE](LICENSE) 文件了解详情。

## 🎨 功能特色

### 智能数据处理
- **自动识别**：智能识别Excel文件中的配色表工作表
- **数据验证**：自动验证数据格式和完整性
- **错误恢复**：提供详细的错误信息和修复建议
- **批量处理**：支持多个主题的批量更新

### 用户体验优化
- **实时预览**：即时预览文件内容和处理结果
- **进度指示**：清晰的处理进度和状态提示
- **操作引导**：详细的使用步骤和操作指南
- **快捷操作**：支持键盘快捷键和右键菜单
- **文件选择反馈**：实时显示文件选择结果和详细信息
- **简洁界面**：优化的UI设计，移除冗余元素，突出核心功能
- **智能状态管理**：自动处理界面状态变化，确保一致性

### 数据安全
- **本地处理**：所有数据处理在浏览器本地完成
- **隐私保护**：不上传任何文件到服务器
- **备份机制**：自动创建文件备份
- **版本控制**：支持文件版本管理和回滚

## 🔍 详细功能说明

### 文件处理流程
1. **文件验证**：检查文件格式、大小和结构
2. **数据解析**：提取Excel文件中的颜色数据
3. **数据映射**：将源数据映射到目标主题结构
4. **数据更新**：更新主题文件中的颜色配置
5. **文件生成**：生成更新后的主题文件

### 支持的数据格式
- **颜色格式**：RGB、HEX、HSL等多种颜色格式
- **数据类型**：数值、文本、公式等Excel数据类型
- **工作表**：支持多工作表文件处理
- **编码格式**：UTF-8、GBK等多种字符编码

### 高级功能
- **文件选择结果显示**：专业的文件信息反馈系统
  - 实时显示文件名、文件大小、选择时间和数据行数
  - 自动格式化文件大小（Bytes/KB/MB/GB）
  - 本地化时间显示，精确到秒
  - 绿色主题成功状态，与整体UI风格一致
  - 错误时自动隐藏，保持界面整洁
- **Light配置管理**：RSC_Theme Light sheet的专业光照参数配置
  - 明度偏移设置：顶面(Max)、侧面(Dark)、底面(Min)的明度调整
  - 高光参数配置：高光等级(SpecularLevel)和光泽度(Gloss)设置
  - 高光颜色选择：16进制颜色值配置，支持专业调色板
  - 实时验证：自动检查数值范围并提供错误提示
- **ColorInfo配置管理**：RSC_Theme ColorInfo sheet的颜色和雾效参数配置
  - 钻石颜色设置：PickupDiffR/G/B，支持RGB颜色选择器和实时预览
  - 钻石反光颜色：PickupReflR/G/B，控制钻石反光效果
  - 远景雾颜色：ForegroundFogR/G/B，设置游戏中雾效颜色
  - 雾效距离参数：FogStart和FogEnd，控制雾效渐变范围
  - RGB颜色选择器：自动拆分颜色为R、G、B数值，支持实时预览
- **UGC图案配置**：UGCTheme图案和边框的可视化选择
  - 图案选择器：从Floor_Pattern.png中选择图案
  - 边框选择器：从Floor_Board.png中选择边框，包括跳板边框
  - 透明度配置：支持0-100范围的透明度设置，默认值优化为50
  - 预览功能：实时预览选中的图案和边框
- **数据导出**：支持JSON、CSV等格式导出
- **模板管理**：保存和复用颜色主题模板
- **批量操作**：一次性处理多个文件
- **自定义映射**：用户自定义数据映射规则

## 📊 性能指标

### 处理能力
- **文件大小**：支持最大10MB的Excel文件
- **数据量**：可处理包含数万行数据的文件
- **响应时间**：通常在3秒内完成数据处理
- **内存使用**：优化的内存管理，避免浏览器卡顿

### 兼容性测试
- ✅ Chrome 86+ (完整功能)
- ✅ Edge 86+ (完整功能)
- ✅ Firefox 90+ (基础功能)
- ✅ Safari 14+ (基础功能)
- ✅ 移动端浏览器 (响应式界面)

## 🛠️ 开发指南

### 本地开发
```bash
# 克隆项目
git clone https://github.com/your-username/ColorToolConnectRC.git
cd ColorToolConnectRC

# 启动开发服务器
python -m http.server 8000
# 或使用 Node.js
npx serve .

# 访问应用
open http://localhost:8000
```

### 代码结构说明
- **模块化设计**：每个功能模块独立开发和测试
- **事件驱动**：基于事件的模块间通信
- **错误边界**：完善的错误捕获和处理机制
- **性能优化**：懒加载和异步处理优化

### 调试技巧
- 打开浏览器开发者工具查看详细日志
- 使用`App.Debug = true`开启调试模式
- 检查控制台错误信息和网络请求
- 使用浏览器的文件访问权限设置

## 📞 联系方式

如有问题或建议，请通过以下方式联系：
- 提交 [GitHub Issue](https://github.com/your-username/ColorToolConnectRC/issues)
- 发送邮件至：your-email@example.com
- 项目讨论：[GitHub Discussions](https://github.com/your-username/ColorToolConnectRC/discussions)

---

## 📋 版本历史

### v1.6.3 (2025-09-25)
**新增功能：VolumetricFog配置管理**

#### 🆕 新增功能
- **VolumetricFog配置系统**：为RSC_Theme.xls新增VolumetricFog工作表的完整数据配置界面
  - 体积雾颜色设置：16进制颜色选择器，与FloodLight配置保持一致的交互体验
  - 体积雾尺寸配置：X、Y、Z（宽度、长度、高度）支持0-100范围的整数输入
  - 体积雾效果设置：Density（浓淡）支持0.1精度的小数输入，Rotate（旋转角度）支持-90到90度
  - 智能开关设计：IsOn使用醒目的toggle switch样式，与FloodLight开关保持一致

#### 🔧 技术实现
- **数据转换机制**：Density字段输入值自动×10存储，读取时自动÷10显示，确保数据格式正确
- **完整数据流程**：包含getVolumetricFogConfigData、applyVolumetricFogConfigToRow等完整处理函数
- **智能验证系统**：X/Y/Z（0-100）、Density（0-20）、Rotate（-90到90）范围验证和自动修正
- **工作表处理集成**：将VolumetricFog添加到所有相关函数的targetSheets列表中

#### 🎨 界面设计
- **橙色主题设计**：VolumetricFog配置面板使用独特的橙色渐变主题，与其他配置面板形成视觉区分
- **Toggle Switch样式**：为开关字段设计了醒目的切换开关，与FloodLight保持一致
- **响应式布局**：配置面板采用网格布局，适配不同屏幕尺寸

#### 🧪 测试和验证
- **专门测试页面**：创建test_volumetricfog_config.html，包含完整的功能验证测试
- **工作流程集成**：完全集成到现有的主题处理工作流程中，支持新建和更新主题
- **向后兼容**：不影响现有Light、ColorInfo、FloodLight配置功能的稳定性

### v1.6.2 (2025-09-25)
**关键修复：FloodLight工作表处理集成**

#### 🔧 重要修复
- **FloodLight工作表处理集成**：修复FloodLight工作表未被添加到处理列表的关键问题
  - 将FloodLight添加到processRSCAdditionalSheets函数的targetSheets列表
  - 将FloodLight添加到updateExistingThemeAdditionalSheets函数的targetSheets列表
  - 将FloodLight添加到generateUpdatedWorkbook函数的targetSheets列表
  - 确保新建和更新主题时FloodLight配置都能正确保存到Excel文件

#### 📝 文档和测试
- **更新函数注释**：所有相关函数的注释都包含FloodLight工作表说明
- **专门测试页面**：创建test_floodlight_processing.html验证工作表处理集成
- **完整数据流程验证**：确保FloodLight配置在整个主题处理流程中正确传递

#### 🎯 影响范围
- 修复前：FloodLight配置界面正常，但数据不会保存到Excel文件
- 修复后：FloodLight配置完全集成到主题处理工作流程，数据正确保存

### v1.6.1 (2025-09-25)
**新增功能：FloodLight配置管理**

#### 🆕 新增功能
- **FloodLight配置系统**：为RSC_Theme.xls新增FloodLight工作表的完整数据配置界面
  - 泛光颜色设置：16进制颜色选择器，与Light配置保持一致的交互体验
  - 泛光参数配置：TippingPoint（临界点）和Strength（强度）支持0.1精度的小数输入
  - 智能开关设计：IsOn和JumpActiveIsLightOn使用醒目的toggle switch样式
  - 自动字段处理：LightStrength字段系统自动填充固定值180

#### 🔧 技术实现
- **数据转换机制**：输入值自动×10存储，读取时自动÷10显示，确保数据格式正确
- **完整数据流程**：包含getFloodLightConfigData、applyFloodLightConfigToRow等完整处理函数
- **智能默认值**：新建主题时使用表中最后一个主题的FloodLight配置作为默认值
- **实时验证系统**：TippingPoint（0-5）、Strength（0-10）范围验证和自动修正

#### 🎨 界面设计
- **青色主题设计**：FloodLight配置面板使用独特的青色渐变主题，与其他配置面板形成视觉区分
- **Toggle Switch样式**：为开关字段设计了醒目的切换开关，提升用户体验
- **响应式布局**：配置面板采用网格布局，适配不同屏幕尺寸

#### 🧪 测试和验证
- **专门测试页面**：创建test_floodlight_config.html，包含完整的功能验证测试
- **工作流程集成**：完全集成到现有的主题处理工作流程中，支持新建和更新主题
- **向后兼容**：不影响现有Light和ColorInfo配置功能的稳定性

### v1.6.0 (2025-09-25)
**重大更新：AllObstacle.xls文件处理功能**

#### 🆕 新增功能
- **AllObstacle.xls自动处理**：支持全新系列主题的AllObstacle数据自动管理
  - 智能触发条件：仅在创建全新系列主题时自动处理AllObstacle文件
  - 自动数据填充：在Info工作表中自动添加新记录，包含ID、基础名称、多语言ID、Sort和isFilter字段
  - 智能字段计算：自动计算新的ID和Sort值（现有最大值+1），提取主题基础名称
  - 完善错误处理：文件不存在、权限失败、重复ID等情况都有适当处理，不影响主流程

#### 🔧 技术改进
- **格式兼容性优化**：优先保存为XLS格式确保与Java工具兼容，避免Office 2007+ XML格式错误
- **多格式保存支持**：支持多种Excel格式尝试和工作簿重建机制，解决XLSX库兼容性问题
- **详细日志输出**：提供丰富的调试日志输出，便于问题追踪和功能验证
- **向后兼容保障**：完全不影响现有的RSC_Theme和UGCTheme处理逻辑，保持系统稳定性

#### 🧪 测试和文档
- **专门测试页面**：创建AllObstacle功能测试页面，包含完整测试用例和验证清单
- **文档完善**：更新相关文档和JSDoc注释，说明AllObstacle处理的触发条件和字段规则
- **使用指南更新**：在README中添加AllObstacle.xls处理的详细说明

#### 🎯 功能特点
- **智能检测**：利用现有的`getSmartMultiLanguageConfig()`函数进行主题类型检测
- **数据行处理**：正确处理Info工作表的数据结构（表头第1行，数据从第6行开始）
- **字段填充规则**：按照业务逻辑正确填充所有必要字段
- **兼容性保证**：确保生成的文件与现有Java工具完全兼容

### v1.5.2 (2025-09-18)
**关键修复：多工作表保存问题解决**

#### 🔧 关键修复
- **修复RSC_Theme多工作表保存逻辑错误**：解决新建主题时Light和ColorInfo工作表数据丢失的问题
- **修复generateUpdatedWorkbook函数条件判断**：移除工作表名称冲突检查，确保Light和ColorInfo工作表始终被正确处理
- **解决数据保存不一致问题**：确保UI显示的缓存状态与实际保存的Excel文件内容完全一致

#### 🎯 问题解决
- **新建主题场景**：现在Light和ColorInfo工作表会正确新增数据行并保存到Excel文件
- **更新主题场景**：确保所有相关工作表都正确更新数据
- **数据完整性**：Light和ColorInfo配置数据现在能够完整保存到最终文件

#### 🛠️ 技术改进
- 增强工作表处理的调试日志，便于问题诊断和追踪
- 添加Light和ColorInfo配置数据的详细验证输出
- 创建专门的诊断工具：`debug_multi_sheet_save.html`
- 完善错误处理和数据完整性检查机制

### v1.5.1 (2025-09-18)
**映射模式优化和CORS问题解决**

#### 🎯 映射模式优化
- **优化检测优先级**：调整映射模式检测逻辑，优先检查"完整配色表"工作表
  - 第一优先级：完整配色表工作表 → JSON间接映射模式
  - 第二优先级：Color工作表 → 直接映射模式
  - 默认情况：都没有找到 → JSON间接映射模式（使用内置数据）
- **修复检测问题**：解决sourceData对象缺少workbook属性导致的检测失败
- **简化直接映射**：移除字段数量限制，只要有Color工作表就启用直接映射模式

#### 🔧 CORS问题解决
- **改进启动脚本**：`start_server.bat`现在会自动打开浏览器并提供更好的用户体验
- **增强错误提示**：在控制台和UI中提供更清晰的CORS问题解决方案
- **新增解决方案文档**：创建`CORS问题解决方案.md`，提供详细的本地访问问题解决指南

#### 📖 文档完善
- **更新README**：添加CORS问题说明、映射模式详细介绍和功能对比表
- **优化使用指南**：提供多种启动方式和详细的环境要求说明
- **完善问题排查**：新增CORS相关问题的详细解决方案

### v1.5.0 (2025-09-18)
**直接映射模式重大更新**

#### 🎯 新增直接映射模式
- **自动模式检测**：根据源数据文件结构自动选择JSON映射或直接映射模式
- **直接字段映射**：支持源数据文件包含Color工作表时的直接字段映射
- **扩展颜色通道**：直接映射模式支持G1-G7和P1-P49的完整范围
- **简化数据验证**：只需检查字段存在性和非空性，无需6位十六进制验证

#### 🎨 UI界面改进
- **映射模式指示器**：在UI中清晰显示当前使用的映射模式
- **源数据文件结果**：显示检测到的映射模式信息和字段数量
- **用户体验优化**：提供清晰的模式切换反馈

#### 🛠️ 技术实现
- **新增核心函数**：detectMappingMode()、updateThemeColorsDirect()、findColorValueDirect()
- **保持向后兼容**：现有JSON映射模式功能完全不受影响，双模式并存
- **完善错误处理**：增强映射模式检测和处理的稳定性

### v1.4.8 (2025-09-18)
**颜色通道映射逻辑修复和文档完善**

#### 🔧 核心修复
- **移除错误的内置直接映射**：修复P3→P3和P4→P4等错误的直接映射关系
  - 从`js/themeManager.js`的`getBuiltinMappingData()`函数中移除P3→P3、P4→P4、P7→P7、P8→P8的直接映射
  - 确保只有在`XLS/对比.json`文件中明确定义的映射关系才会触发颜色查找
  - 保持正确的间接映射：P11→P3、P15→P4等映射关系不受影响

#### 🎯 映射逻辑优化
- **两阶段处理机制**：完善颜色通道的处理逻辑
  - **第一阶段**：根据映射文件执行颜色查找和更新
  - **第二阶段**：对未映射通道检查现有值，有效则保持，无效则设置默认值FFFFFF
- **P3和P4通道的正确行为**：
  - P3通道：无映射关系，保持RSC_Theme文件中的现有值（如26191E）
  - P4通道：无映射关系，保持RSC_Theme文件中的现有值（如32D9D1）
  - P11通道：通过映射获取源数据中P3颜色代码的值
  - P15通道：通过映射获取源数据中P4颜色代码的值

#### 📖 文档完善
- **新增颜色通道映射逻辑章节**：详细说明映射原理和处理流程
  - 核心映射原理：两阶段处理机制的详细说明
  - P3和P4通道的特殊情况：现有值保持逻辑的解释
  - 映射配置文件结构：JSON文件格式和字段说明
  - 技术实现细节：关键函数和验证逻辑
  - 自定义映射配置：如何修改和扩展映射关系
- **实际处理结果示例**：提供具体的数据处理示例和日志输出格式

#### 🛠️ 技术改进
- **映射逻辑的可控性**：确保映射关系完全由JSON文件控制，便于维护和调整
- **向后兼容性**：保持现有功能的完全兼容，不影响其他颜色通道的处理
- **错误处理完善**：改进未映射通道的处理逻辑，确保数据的一致性和可靠性

#### 📊 影响范围
- **仅影响**：P3、P4、P7、P8等预留通道的映射处理逻辑
- **不影响**：其他正常颜色通道的映射和处理流程
- **向后兼容**：现有主题文件和映射配置保持100%兼容

### v1.4.7 (2025-09-12)
**Level_show_id字段填值逻辑修正**

#### 🔧 Bug修复
- **UGCTheme表Level_show_id字段逻辑优化**：修正填值策略，根据主题类型采用不同计算方式
  - 全新主题系列：Level_show_id = 新增主题ID - 1
  - 现有主题系列：Level_show_id = 上一行数据值 + 1（保持原有逻辑）
  - 基于智能多语言配置系统实现主题类型自动识别
  - 确保数据处理的准确性和业务逻辑的正确性

#### 🛠️ 技术改进
- **智能填值策略**：利用现有的主题相似性检测功能，自动判断主题类型
- **详细日志输出**：添加填值过程的详细记录，包含计算来源和处理步骤
- **兼容性保障**：与多语言配置功能完全兼容，不影响现有功能
- **错误处理完善**：处理列不存在和数据异常情况，确保系统稳定性

#### 📊 影响范围
- **仅影响**：创建全新主题系列时的Level_show_id计算
- **不影响**：更新现有主题、现有系列新增、其他字段处理
- **向后兼容**：现有主题系列的行为保持100%一致

### v1.4.6 (2025-09-12)
**UI优化和用户体验提升**

#### 🆕 新增功能
- **源数据文件选择结果显示**：新增文件选择成功后的详细信息显示
  - 显示文件名、文件大小、选择时间和数据行数
  - 使用绿色主题的成功状态显示，与项目整体UI风格一致
  - 支持实时文件信息更新，包括格式化的文件大小和精确的选择时间
  - 集成到文件处理流程，提供即时的操作反馈

#### 🎨 界面优化
- **简化UI设计**：移除冗余的界面元素，提供更清洁的用户体验
  - 完全移除文件状态栏，减少界面复杂度
  - 删除右侧信息区域（文件选择状态指示器），界面更加简洁
  - 优化布局结构，突出核心功能操作
- **固定路径显示**：最终操作指引弹窗使用固定路径显示
  - 路径显示为：`rs_ugc2\RS_UGC_Unity_2021.3.31\Tools`
  - 移除动态路径生成逻辑，提供更明确的操作指引
  - 简化用户理解，避免路径显示的混淆

#### 🔧 功能完善
- **完整的错误处理机制**：确保用户体验的流畅性
  - 文件格式错误时自动隐藏结果显示
  - 文件过大时自动隐藏结果显示
  - 文件解析失败时自动隐藏结果显示
  - 文件读取失败时自动隐藏结果显示
- **状态管理优化**：改进文件选择状态的管理逻辑
  - 集成文件选择结果到重置功能，确保界面状态一致性
  - 修改状态更新函数，静默处理不存在的元素，避免控制台警告
  - 保持与现有功能的完全兼容性

#### 🛠️ 技术改进
- **模块化文件处理**：新增专门的文件选择结果显示函数
  - `updateSourceFileSelectionResult()`：更新文件选择结果显示
  - `hideSourceFileSelectionResult()`：隐藏文件选择结果显示
  - 集成到所有文件处理和错误处理流程
- **数据格式化**：提供专业的文件信息格式化
  - 文件大小自动格式化（Bytes/KB/MB/GB）
  - 时间戳格式化为本地化时间显示
  - 数据行数统计和显示

### v1.4.5 (2025-09-12)
**图案资源更新**
- 更新图案资源文件

### v1.4.4 (2025-09-10)
**新增功能：BallSpec钻石高光颜色配置**

### v1.4.3 (2025-01-10)
**重大修复：Light和ColorInfo数据保存问题完全解决**

#### 🔧 关键修复
- **修复Light和ColorInfo数据保存的关键问题**：确保配置数据正确写入Excel文件
- **解决新建主题时Light和ColorInfo工作表不创建新行的问题**：修复processRSCAdditionalSheets函数缺少rscAllSheetsData更新的缺陷
- **修复更新现有主题时Light和ColorInfo配置被忽略的问题**：新增updateExistingThemeAdditionalSheets函数专门处理现有主题更新
- **修复generateUpdatedWorkbook函数只处理主工作表的缺陷**：现在正确处理所有工作表(Color、Light、ColorInfo)

#### 🎯 功能完善
- **完善数据流程**：确保无论新建还是更新主题，Light和ColorInfo配置都能正确保存
- **移除过时的功能限制说明**：现在所有配置功能都完全可用，不再有数据保存限制
- **优化数据同步逻辑**：确保workbook.Sheets和rscAllSheetsData保持一致
- **添加详细的调试日志**：便于问题诊断和数据流程追踪

#### 🛠️ 技术改进
- 修复processRSCAdditionalSheets函数在新建主题时没有更新rscAllSheetsData的问题
- 新增updateExistingRowInSheet函数，查找并更新现有主题行的配置数据
- 完善错误处理机制，对找不到主题行的情况进行健壮处理
- 统一处理逻辑，新建和更新主题都使用相同的数据处理模式

### v1.4.4 (2025-01-10)
**新增功能：BallSpec钻石高光颜色配置**

#### 🆕 新增功能
- **BallSpec钻石高光颜色配置**：为ColorInfo配置面板新增钻石高光颜色设置
  - BallSpecR、BallSpecG、BallSpecB：RGB值范围 0-255
  - 支持可视化颜色选择器，自动拆分为R、G、B三个数值
  - 实时颜色预览，显示RGB组合的实际效果
  - 控制钻石的高光颜色效果，提供更丰富的视觉表现

#### 🔧 功能完善
- **完整的数据处理流程**：BallSpec字段集成到所有相关函数
  - 数据收集：getColorInfoConfigData()函数支持BallSpec字段
  - 数据应用：applyColorInfoConfigToRow()函数支持BallSpec字段写入
  - 数据验证：initColorInfoValidation()函数支持BallSpec字段验证
  - 默认值处理：getLastThemeColorInfoConfig()函数支持BallSpec默认值
  - 颜色预览：updateRgbColorPreview()函数支持BallSpec颜色预览

#### 🐛 问题修复
- **修复现有主题数据读取问题**：loadExistingColorInfoConfig()函数缺少BallSpec字段映射
- **确保字段映射一致性**：所有ColorInfo相关函数的字段映射完全一致
- **完善数据流程**：新建和更新主题时BallSpec配置都能正确保存到Excel文件

#### 🎨 用户体验提升
- **丰富的钻石颜色配置**：现在支持钻石颜色、反光颜色、高光颜色三种颜色效果
- **统一的操作体验**：BallSpec配置与现有PickupDiff、PickupRefl配置保持一致的操作方式
- **完整的功能测试**：提供专门的BallSpec功能测试页面，确保功能稳定性

### v1.4.1 (2025-01-10)
**重要更新：RSC_Theme ColorInfo配置功能和UGC图案选择器增强**

#### 🆕 新增功能
- **RSC_Theme ColorInfo配置系统**：完整的颜色和雾效参数配置界面
  - 钻石颜色设置：PickupDiffR/G/B，支持RGB颜色选择器
  - 钻石反光颜色：PickupReflR/G/B，控制反光效果
  - 远景雾颜色：ForegroundFogR/G/B，设置雾效颜色
  - 雾效距离参数：FogStart (0-40)、FogEnd (0-90)
- **RGB颜色选择器**：专门的RGB模式颜色选择工具
  - 支持颜色自动拆分为R、G、B三个数值字段
  - 实时颜色预览，显示RGB组合的实际效果
  - 与现有HEX颜色选择器完美集成

#### 🔧 功能优化
- **跳板边框图案选择器**：全面升级的图案选择体验
  - 添加可视化边框图案选择器，与地板边框保持一致
  - 移除0/1限制，支持任意有效的边框图案ID
  - 输入框设置为只读，确保通过选择器设置有效值
- **智能默认值系统**：更智能的新建主题默认值逻辑
  - Light配置：新建主题时使用表中最后一个主题的Light数据作为默认值
  - ColorInfo配置：新建主题时使用表中最后一个主题的ColorInfo数据作为默认值
  - 玻璃透明度：修复默认值为50，提供更合理的初始值

#### 🎨 界面改进
- **ColorInfo配置面板**：专业的颜色配置界面
  - 紫色渐变主题，与Light配置面板形成视觉区分
  - RGB输入组件，分别显示R、G、B数值
  - 实时颜色预览框，显示RGB组合效果
- **跳板边框配置**：统一的图案选择体验
  - 与地板边框图案选择器保持一致的UI设计
  - 移除限制性注释，提供更清晰的操作指引

#### 🛠️ 技术改进
- **模块化颜色选择器**：扩展支持RGB和HEX两种模式
- **智能数据继承**：新建主题时从现有数据中获取合理默认值
- **完整验证系统**：RGB值和雾距离的实时验证和自动修正
- **优化事件处理**：改进图案选择器的事件绑定机制

### v1.4.0 (2025-01-09)
**重大更新：RSC_Theme Light配置功能和UGC图案选择器优化**

#### 🆕 新增功能
- **RSC_Theme Light配置系统**：完整的光照参数可视化配置界面
  - 明度偏移设置：Max、Dark、Min字段，支持-255到255范围
  - 高光参数配置：SpecularLevel (0-1000)、Gloss (10-1000)
  - 高光颜色选择：16进制颜色值配置，带专业调色板
- **专业颜色选择器**：全新的颜色选择工具
  - 360度色相×明度渐变色板
  - 16种预设常用颜色快速选择
  - 16进制颜色值手动输入和验证
  - 实时颜色预览和格式转换
- **实时数值验证系统**：智能输入验证和错误处理
  - 自动范围检查和边界值修正
  - 实时错误提示和视觉反馈
  - 输入格式验证和自动清理

#### 🔧 功能优化
- **UGC图案选择器修复**：解决图案选择按钮无响应问题
  - 修复事件委托和直接绑定的冲突
  - 优化动态面板显示时的事件重新绑定
  - 改进模态框显示和图案预选功能
- **Light配置集成**：完整的数据流程支持
  - 新建主题时显示Light配置面板
  - 现有主题加载时自动填充Light配置值
  - Light配置数据的验证、获取和保存

#### 🎨 界面改进
- **Light配置面板UI**：专业的光照参数配置界面
  - 分组布局：明度偏移设置 + 高光设置
  - 字段说明：每个参数都有详细的使用提示
  - 视觉风格：与UGC配置面板保持一致的设计语言
- **颜色选择器界面**：现代化的颜色选择体验
  - 渐变色板：直观的颜色选择操作
  - 预设颜色网格：快速选择常用颜色
  - 实时预览：颜色变化的即时反馈

#### 🛠️ 技术改进
- **模块化架构**：新增独立的颜色选择器模块
- **验证系统**：完整的Light字段验证函数集
- **事件管理**：优化的事件绑定和委托机制
- **错误处理**：增强的输入异常处理和用户反馈

#### 📝 文档更新
- 添加Light配置功能的详细说明
- 更新项目结构和技术栈信息
- 完善使用指南和功能特性描述

### v1.2.0 (2025-09-05)
**主要更新：主题处理逻辑优化和功能说明完善**
- 🔧 修复主题提取逻辑，正确从第6行开始读取主题数据
- 🎯 优化更新模式下UGCTheme文件处理逻辑，明确跳过处理的原因
- 💬 改进错误提示，明确指出缺少的具体文件类型
- 📝 完善主题数据处理流程和用户反馈机制
- ⚠️ 添加功能限制说明：部分数据如雾色花纹使用上一个主题的数据
- 🎨 增强UI界面，添加功能说明和版本信息显示
- 📖 更新文档，完善使用指南和版本历史

**技术改进：**
- 修正主题名称提取的起始行索引（从第6行开始）
- 优化processUGCTheme函数的处理逻辑
- 改进processThemeData函数的错误提示机制
- 添加详细的功能限制说明和用户引导

**用户体验：**
- 更清晰的错误提示信息
- 完善的功能说明和使用指导
- 优化的版本信息展示

### v1.1.1 (2025-09-05)
**主要更新：Excel格式兼容性修复**
- 🔧 修复Excel文件格式兼容性问题
- 📝 统一使用.xls格式以兼容Unity工具
- 🐛 解决Apache POI HSSF库读取错误
- ✨ 添加版本显示功能
- 🚀 优化文件保存和下载流程
- 📱 改进响应式界面设计
- 🔍 增强错误提示和调试信息

**技术改进：**
- 所有`XLSX.write()`调用统一使用`bookType: 'xls'`
- 更新MIME类型为`application/vnd.ms-excel`
- 修复文件扩展名和下载文件名
- 添加版本管理模块和更新通知

### v1.0.0 (2025-01-08)
**初始版本发布**
- 🎉 项目初始化和基础架构搭建
- 📊 实现颜色主题数据处理功能
- 📁 支持RSC_Theme和UGCTheme文件管理
- 🔗 添加File System Access API支持
- 👀 实现数据预览和Sheet选择功能
- 📱 添加响应式界面设计
- 🎯 支持拖拽文件上传
- 🔄 实现数据同步和映射功能
- 🛠️ 完善错误处理和用户反馈
- 📖 添加使用指南和帮助文档

**核心功能：**
- Excel文件解析和处理
- 颜色数据映射和更新
- 多种文件保存方式
- 浏览器兼容性检测
- 模块化代码架构
