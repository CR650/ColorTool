# 更新日志

## [1.5.2] - 2025-09-18

### 🔧 关键修复
- **修复RSC_Theme多工作表保存逻辑错误**：解决新建主题时Light和ColorInfo工作表数据丢失的严重问题
- **修复generateUpdatedWorkbook函数条件判断**：移除错误的工作表名称冲突检查逻辑
- **解决数据保存不一致问题**：确保UI显示状态与实际保存文件内容完全一致

### 🎯 问题解决
- 新建主题时Light和ColorInfo工作表现在会正确新增数据并保存到Excel文件
- 更新现有主题时所有相关工作表都能正确更新数据
- 修复了generateUpdatedWorkbook中`sheetName !== originalSheetName`的错误条件

### 🛠️ 技术改进
- 增强工作表处理的详细调试日志，便于问题诊断
- 添加Light和ColorInfo配置数据的验证输出
- 创建专门的诊断工具：`debug_multi_sheet_save.html`
- 完善数据完整性检查和错误处理机制

## [1.5.1] - 2025-09-18

### 🎯 映射模式优化
- 优化映射模式检测优先级：完整配色表工作表 > Color工作表 > 默认JSON模式
- 修复sourceData对象缺少workbook属性导致的直接映射模式检测失败问题
- 简化直接映射字段匹配逻辑，移除字段数量限制

### 🔧 CORS问题解决
- 改进`start_server.bat`启动脚本，现在会自动打开浏览器
- 增强CORS错误提示，在控制台和UI中提供清晰的解决方案
- 新增`CORS问题解决方案.md`文档，提供详细的本地访问问题解决指南

### 📖 文档完善
- 更新README文档，添加CORS问题说明和映射模式详细介绍
- 新增功能对比表，清晰展示不同访问方式的功能差异
- 完善问题排查章节，提供更详细的故障解决方案

## [1.5.0] - 2025-09-18

### 🎯 重大功能更新
- **新增直接映射模式**：支持源数据文件包含Color工作表时的直接字段映射
- **自动映射模式检测**：根据源数据文件结构自动选择合适的映射模式
- **扩展颜色通道支持**：直接映射模式支持G1-G7和P1-P49的完整范围

### 🎨 UI界面改进
- 添加映射模式指示器，清晰显示当前使用的映射模式
- 源数据文件选择结果中显示检测到的映射模式信息
- 优化用户体验，提供清晰的模式切换反馈

### 🛠️ 技术实现
- 新增核心函数：`detectMappingMode()`、`updateThemeColorsDirect()`、`findColorValueDirect()`
- 保持向后兼容性，现有JSON映射模式功能完全不受影响
- 实现双模式并存，根据数据结构自动选择处理方式

### 📋 数据处理优化
- 简化直接映射模式的数据验证，只检查字段存在性和非空性
- 优化映射逻辑，提高处理效率
- 完善错误处理机制，增强系统稳定性

## [1.4.8] - 2025-09-18

### 🔧 映射逻辑修复
- 移除错误的内置直接映射（P3→P3、P4→P4等）
- 完善两阶段颜色通道处理机制
- 优化P3和P4通道的处理逻辑

### 📖 文档完善
- 新增颜色通道映射逻辑详细说明
- 添加技术实现细节和配置示例
- 完善实际处理结果示例

## 版本说明

### 版本号规则
- **主版本号**：重大功能更新或架构变更
- **次版本号**：新功能添加或重要改进
- **修订版本号**：问题修复和小幅优化

### 更新类型
- 🎯 **功能更新**：新功能添加或重要功能改进
- 🔧 **问题修复**：Bug修复和逻辑优化
- 🎨 **界面改进**：UI/UX优化和视觉改进
- 📖 **文档更新**：文档完善和说明改进
- 🛠️ **技术优化**：代码重构和性能优化
- 📋 **数据处理**：数据处理逻辑改进

### 兼容性说明
- **向后兼容**：新版本保持与旧版本的完全兼容
- **功能增强**：在保持兼容的基础上增加新功能
- **渐进式改进**：通过版本迭代逐步完善功能
