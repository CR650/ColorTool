<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤šå·¥ä½œè¡¨ä¿å­˜é—®é¢˜è¯Šæ–­</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        .test-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
        }
        .test-btn:hover {
            background: #0056b3;
        }
        .result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .warning { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” å¤šå·¥ä½œè¡¨ä¿å­˜é—®é¢˜è¯Šæ–­å·¥å…·</h1>
        
        <div class="test-section">
            <h3>ğŸ“‹ é—®é¢˜æè¿°</h3>
            <p><strong>é—®é¢˜</strong>ï¼šæ–°å»ºä¸»é¢˜æ—¶ï¼ŒUIæ˜¾ç¤ºLightå’ŒColorInfoå·¥ä½œè¡¨å·²æ–°å¢æ•°æ®ï¼Œä½†å®é™…ä¿å­˜çš„Excelæ–‡ä»¶ä¸­è¿™äº›å·¥ä½œè¡¨æ²¡æœ‰æ–°å¢æ•°æ®ã€‚</p>
            <p><strong>æ€€ç–‘åŸå› </strong>ï¼šå·¥ä½œè¡¨ä¿å­˜èŒƒå›´è¢«é”™è¯¯é™åˆ¶ï¼Œæˆ–è€…æ•°æ®æµç¨‹ä¸­å­˜åœ¨é—®é¢˜ã€‚</p>
        </div>

        <div class="test-section">
            <h3>ğŸ”§ è¯Šæ–­æµ‹è¯•</h3>
            <button class="test-btn" onclick="checkRscAllSheetsData()">æ£€æŸ¥rscAllSheetsDataçŠ¶æ€</button>
            <button class="test-btn" onclick="checkWorkbookStructure()">æ£€æŸ¥å·¥ä½œç°¿ç»“æ„</button>
            <button class="test-btn" onclick="simulateNewThemeProcess()">æ¨¡æ‹Ÿæ–°å»ºä¸»é¢˜æµç¨‹</button>
            <button class="test-btn" onclick="checkGenerateUpdatedWorkbook()">æ£€æŸ¥generateUpdatedWorkbooké€»è¾‘</button>
            <button class="test-btn" onclick="checkDataFlow()">æ£€æŸ¥æ•°æ®æµç¨‹</button>
        </div>

        <div class="test-section">
            <h3>ğŸ“Š è¯Šæ–­ç»“æœ</h3>
            <div id="results"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ¯ å…³é”®æ£€æŸ¥ç‚¹</h3>
            <ul>
                <li><strong>rscAllSheetsDataåˆå§‹åŒ–</strong>ï¼šæ˜¯å¦æ­£ç¡®åŒ…å«Lightå’ŒColorInfoå·¥ä½œè¡¨æ•°æ®</li>
                <li><strong>processRSCAdditionalSheets</strong>ï¼šæ˜¯å¦æ­£ç¡®æ›´æ–°rscAllSheetsData</li>
                <li><strong>generateUpdatedWorkbook</strong>ï¼šæ˜¯å¦æ­£ç¡®å¤„ç†Lightå’ŒColorInfoå·¥ä½œè¡¨</li>
                <li><strong>å·¥ä½œè¡¨åç§°æ¡ä»¶</strong>ï¼šæ˜¯å¦å­˜åœ¨åç§°å†²çªå¯¼è‡´è·³è¿‡å¤„ç†</li>
                <li><strong>æ•°æ®å®Œæ•´æ€§</strong>ï¼šLightå’ŒColorInfoæ•°æ®æ˜¯å¦æ­£ç¡®åº”ç”¨åˆ°æ–°è¡Œ</li>
            </ul>
        </div>
    </div>

    <script>
        function addResult(message, type = 'info') {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = `result ${type}`;
            div.textContent = message;
            results.appendChild(div);
        }

        function clearResults() {
            document.getElementById('results').innerHTML = '';
        }

        // æ£€æŸ¥rscAllSheetsDataçŠ¶æ€
        function checkRscAllSheetsData() {
            clearResults();
            addResult('ğŸ” å¼€å§‹æ£€æŸ¥rscAllSheetsDataçŠ¶æ€...', 'info');

            if (window.App && window.App.ThemeManager) {
                // å°è¯•è®¿é—®ç§æœ‰å˜é‡ï¼ˆé€šè¿‡è°ƒè¯•æ–¹å¼ï¼‰
                addResult('âœ… ThemeManageræ¨¡å—å¯è®¿é—®', 'success');
                
                // æ£€æŸ¥æ˜¯å¦æœ‰RSCæ–‡ä»¶å·²åŠ è½½
                addResult('ğŸ“‹ æ£€æŸ¥RSCæ–‡ä»¶åŠ è½½çŠ¶æ€...', 'info');
                addResult('æ³¨æ„ï¼šrscAllSheetsDataæ˜¯ç§æœ‰å˜é‡ï¼Œéœ€è¦åœ¨å®é™…æ“ä½œä¸­é€šè¿‡æ§åˆ¶å°æŸ¥çœ‹', 'warning');
                addResult('å»ºè®®ï¼šåœ¨é€‰æ‹©RSCæ–‡ä»¶åï¼Œåœ¨æ§åˆ¶å°è¾“å…¥ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹ï¼š', 'info');
                addResult('console.log("rscAllSheetsData:", rscAllSheetsData);', 'info');
            } else {
                addResult('âŒ ThemeManageræ¨¡å—ä¸å¯è®¿é—®', 'error');
            }
        }

        // æ£€æŸ¥å·¥ä½œç°¿ç»“æ„
        function checkWorkbookStructure() {
            addResult('ğŸ” å¼€å§‹æ£€æŸ¥å·¥ä½œç°¿ç»“æ„...', 'info');
            
            addResult('ğŸ“‹ æ ‡å‡†RSC_Theme.xlså·¥ä½œè¡¨ç»“æ„ï¼š', 'info');
            addResult('- ä¸»å·¥ä½œè¡¨ï¼ˆé€šå¸¸æ˜¯ç¬¬ä¸€ä¸ªå·¥ä½œè¡¨ï¼ŒåŒ…å«é¢œè‰²æ•°æ®ï¼‰', 'info');
            addResult('- Lightå·¥ä½œè¡¨ï¼ˆå…‰ç…§å‚æ•°é…ç½®ï¼‰', 'info');
            addResult('- ColorInfoå·¥ä½œè¡¨ï¼ˆé¢œè‰²æ•ˆæœå’Œé›¾æ•ˆå‚æ•°ï¼‰', 'info');
            
            addResult('âš ï¸ å…³é”®æ£€æŸ¥ç‚¹ï¼š', 'warning');
            addResult('1. ä¸»å·¥ä½œè¡¨åç§°æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆworkbook.SheetNames[0]ï¼‰', 'warning');
            addResult('2. Lightå’ŒColorInfoå·¥ä½œè¡¨æ˜¯å¦å­˜åœ¨ï¼Ÿ', 'warning');
            addResult('3. æ˜¯å¦å­˜åœ¨åç§°å†²çªï¼Ÿï¼ˆä¸»å·¥ä½œè¡¨åç§° === "Light" æˆ– "ColorInfo"ï¼‰', 'warning');
        }

        // æ¨¡æ‹Ÿæ–°å»ºä¸»é¢˜æµç¨‹
        function simulateNewThemeProcess() {
            addResult('ğŸ” æ¨¡æ‹Ÿæ–°å»ºä¸»é¢˜æµç¨‹...', 'info');
            
            addResult('ğŸ“‹ æ–°å»ºä¸»é¢˜æ•°æ®æµç¨‹ï¼š', 'info');
            addResult('1. ç”¨æˆ·è¾“å…¥ä¸»é¢˜åç§°', 'info');
            addResult('2. è°ƒç”¨processTheme() -> processRSCAdditionalSheets(themeName, true)', 'info');
            addResult('3. processRSCAdditionalSheetså¤„ç†Lightå’ŒColorInfoå·¥ä½œè¡¨', 'info');
            addResult('4. è°ƒç”¨addNewRowToSheet()ä¸ºæ¯ä¸ªå·¥ä½œè¡¨æ·»åŠ æ–°è¡Œ', 'info');
            addResult('5. åº”ç”¨ç”¨æˆ·é…ç½®ï¼šapplyLightConfigToRow() å’Œ applyColorInfoConfigToRow()', 'info');
            addResult('6. æ›´æ–°rscAllSheetsData[sheetName] = sheetData', 'info');
            addResult('7. è°ƒç”¨generateUpdatedWorkbook()ç”Ÿæˆæœ€ç»ˆå·¥ä½œç°¿', 'info');
            addResult('8. generateUpdatedWorkbook()å¤„ç†targetSheets = ["Light", "ColorInfo"]', 'info');
            
            addResult('âš ï¸ å¯èƒ½çš„é—®é¢˜ç‚¹ï¼š', 'warning');
            addResult('- æ­¥éª¤6ï¼šrscAllSheetsDataæ›´æ–°æ˜¯å¦æˆåŠŸï¼Ÿ', 'warning');
            addResult('- æ­¥éª¤8ï¼šgenerateUpdatedWorkbookæ˜¯å¦æ­£ç¡®å¤„ç†Lightå’ŒColorInfoï¼Ÿ', 'warning');
        }

        // æ£€æŸ¥generateUpdatedWorkbooké€»è¾‘
        function checkGenerateUpdatedWorkbook() {
            addResult('ğŸ” æ£€æŸ¥generateUpdatedWorkbooké€»è¾‘...', 'info');
            
            addResult('ğŸ“‹ generateUpdatedWorkbookå…³é”®é€»è¾‘ï¼š', 'info');
            addResult('const originalSheetName = workbook.SheetNames[0];', 'info');
            addResult('const targetSheets = ["Light", "ColorInfo"];', 'info');
            addResult('æ¡ä»¶ï¼šif (sheetName !== originalSheetName && rscAllSheetsData[sheetName])', 'info');
            
            addResult('ğŸš¨ å‘ç°æ½œåœ¨é—®é¢˜ï¼', 'error');
            addResult('å¦‚æœä¸»å·¥ä½œè¡¨åç§°æ˜¯"Light"æˆ–"ColorInfo"ï¼Œä¼šå¯¼è‡´æ¡ä»¶å¤±è´¥ï¼', 'error');
            addResult('æ¡ä»¶ï¼šsheetName !== originalSheetName', 'error');
            addResult('å¦‚æœoriginalSheetName === "Light"ï¼Œåˆ™Lightå·¥ä½œè¡¨ä¼šè¢«è·³è¿‡ï¼', 'error');
            
            addResult('ğŸ”§ å»ºè®®ä¿®å¤æ–¹æ¡ˆï¼š', 'success');
            addResult('ä¿®æ”¹æ¡ä»¶é€»è¾‘ï¼Œå…è®¸å¤„ç†æ‰€æœ‰ç›®æ ‡å·¥ä½œè¡¨ï¼Œä¸ç®¡æ˜¯å¦ä¸ä¸»å·¥ä½œè¡¨åŒå', 'success');
        }

        // æ£€æŸ¥æ•°æ®æµç¨‹
        function checkDataFlow() {
            addResult('ğŸ” æ£€æŸ¥å®Œæ•´æ•°æ®æµç¨‹...', 'info');
            
            addResult('ğŸ“‹ æ•°æ®æµç¨‹æ£€æŸ¥æ¸…å•ï¼š', 'info');
            addResult('âœ… 1. RSCæ–‡ä»¶åŠ è½½ -> rscAllSheetsDataåˆå§‹åŒ–', 'success');
            addResult('âœ… 2. ç”¨æˆ·é…ç½®Lightå’ŒColorInfoå‚æ•°', 'success');
            addResult('âœ… 3. processRSCAdditionalSheetsè°ƒç”¨', 'success');
            addResult('âœ… 4. addNewRowToSheetæ·»åŠ æ–°è¡Œ', 'success');
            addResult('âœ… 5. applyLightConfigToRow/applyColorInfoConfigToRowåº”ç”¨é…ç½®', 'success');
            addResult('âœ… 6. æ›´æ–°rscAllSheetsData', 'success');
            addResult('âŒ 7. generateUpdatedWorkbookå¤„ç†ç›®æ ‡å·¥ä½œè¡¨ï¼ˆå¯èƒ½æœ‰é—®é¢˜ï¼‰', 'error');
            addResult('âŒ 8. æœ€ç»ˆExcelæ–‡ä»¶ä¿å­˜ï¼ˆLightå’ŒColorInfoæ•°æ®ä¸¢å¤±ï¼‰', 'error');
            
            addResult('ğŸ¯ é—®é¢˜å®šä½ï¼š', 'warning');
            addResult('é—®é¢˜å¾ˆå¯èƒ½å‡ºç°åœ¨generateUpdatedWorkbookçš„æ¡ä»¶åˆ¤æ–­ä¸­', 'warning');
            addResult('éœ€è¦æ£€æŸ¥ä¸»å·¥ä½œè¡¨åç§°æ˜¯å¦ä¸Lightæˆ–ColorInfoå†²çª', 'warning');
        }

        // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºåˆå§‹ä¿¡æ¯
        window.onload = function() {
            addResult('ğŸš€ å¤šå·¥ä½œè¡¨ä¿å­˜é—®é¢˜è¯Šæ–­å·¥å…·å·²åŠ è½½', 'success');
            addResult('è¯·å…ˆåŠ è½½RSC_Themeæ–‡ä»¶ï¼Œç„¶åè¿è¡Œè¯Šæ–­æµ‹è¯•', 'info');
        };
    </script>
</body>
</html>
